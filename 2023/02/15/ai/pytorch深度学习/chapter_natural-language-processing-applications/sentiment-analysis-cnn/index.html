<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="yuan" href="https://huang-junyuan.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="yuan" href="https://huang-junyuan.github.io/atom.xml"><link rel="alternate" type="application/json" title="yuan" href="https://huang-junyuan.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="chapter_natural-language-processing-applications"><link rel="canonical" href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/sentiment-analysis-cnn/"><title>sentiment-analysis-cnn - chapter_natural-language-processing-applications - pytorchæ·±åº¦å­¦ä¹  - ai | Mi Manchi = yuan = Whatever is worth doing at all is worth doing well</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">sentiment-analysis-cnn</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2023-02-15 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2023-02-15T00:00:00+08:00">2023-02-15</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>5.1k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>5 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Mi Manchi</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(86).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(13).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(27).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(62).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(66).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(16).webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/" itemprop="item" rel="index" title="åˆ†ç±»äº ai"><span itemprop="name">ai</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="item" rel="index" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ "><span itemprop="name">pytorchæ·±åº¦å­¦ä¹ </span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-natural-language-processing-applications/" itemprop="item" rel="index" title="åˆ†ç±»äº chapter_natural-language-processing-applications"><span itemprop="name">chapter_natural-language-processing-applications</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/sentiment-analysis-cnn/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="yuan"><meta itemprop="description" content="Whatever is worth doing at all is worth doing well, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="yuan"></span><div class="body md" itemprop="articleBody"><h1 id="æƒ…æ„Ÿåˆ†æä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œ"><a class="anchor" href="#æƒ…æ„Ÿåˆ†æä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œ">#</a> æƒ…æ„Ÿåˆ†æï¼šä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œ</h1><p>ğŸ· <code>sec_sentiment_cnn</code></p><p>åœ¨ :numref: <code>chap_cnn</code> ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†ä½¿ç”¨äºŒç»´å·ç§¯ç¥ç»ç½‘ç»œå¤„ç†äºŒç»´å›¾åƒæ•°æ®çš„æœºåˆ¶ï¼Œå¹¶å°†å…¶åº”ç”¨äºå±€éƒ¨ç‰¹å¾ï¼Œå¦‚ç›¸é‚»åƒç´ ã€‚è™½ç„¶å·ç§¯ç¥ç»ç½‘ç»œæœ€åˆæ˜¯ä¸ºè®¡ç®—æœºè§†è§‰è®¾è®¡çš„ï¼Œä½†å®ƒä¹Ÿè¢«å¹¿æ³›ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ã€‚ç®€å•åœ°è¯´ï¼Œåªè¦å°†ä»»ä½•æ–‡æœ¬åºåˆ—æƒ³è±¡æˆä¸€ç»´å›¾åƒå³å¯ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œå¯ä»¥å¤„ç†æ–‡æœ¬ä¸­çš„å±€éƒ¨ç‰¹å¾ï¼Œä¾‹å¦‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> å…ƒè¯­æ³•ã€‚</p><p>æœ¬èŠ‚å°†ä½¿ç”¨<em> textCNN</em> æ¨¡å‹æ¥æ¼”ç¤ºå¦‚ä½•è®¾è®¡ä¸€ä¸ªè¡¨ç¤ºå•ä¸ªæ–‡æœ¬ :cite: <code>Kim.2014</code> çš„å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„ã€‚ä¸ :numref: <code>fig_nlp-map-sa-rnn</code> ä¸­ä½¿ç”¨å¸¦æœ‰ GloVe é¢„è®­ç»ƒçš„å¾ªç¯ç¥ç»ç½‘ç»œæ¶æ„è¿›è¡Œæƒ…æ„Ÿåˆ†æç›¸æ¯”ï¼Œ :numref: <code>fig_nlp-map-sa-cnn</code> ä¸­å”¯ä¸€çš„åŒºåˆ«åœ¨äºæ¶æ„çš„é€‰æ‹©ã€‚</p><p><img data-src="/./images/nlp-map-sa-cnn.svg" alt="å°†GloVeæ”¾å…¥å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„è¿›è¡Œæƒ…æ„Ÿåˆ†æ"><br>ğŸ· <code>fig_nlp-map-sa-cnn</code></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> torch</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> torch <span class="token keyword">import</span> nn</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> d2l <span class="token keyword">import</span> torch <span class="token keyword">as</span> d2l</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>batch_size <span class="token operator">=</span> <span class="token number">64</span></pre></td></tr><tr><td data-num="6"></td><td><pre>train_iter<span class="token punctuation">,</span> test_iter<span class="token punctuation">,</span> vocab <span class="token operator">=</span> d2l<span class="token punctuation">.</span>load_data_imdb<span class="token punctuation">(</span>batch_size<span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="ä¸€ç»´å·ç§¯"><a class="anchor" href="#ä¸€ç»´å·ç§¯">#</a> ä¸€ç»´å·ç§¯</h2><p>åœ¨ä»‹ç»è¯¥æ¨¡å‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹ä¸€ç»´å·ç§¯æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚è¯·è®°ä½ï¼Œè¿™åªæ˜¯åŸºäºäº’ç›¸å…³è¿ç®—çš„äºŒç»´å·ç§¯çš„ç‰¹ä¾‹ã€‚</p><p><img data-src="/./images/conv1d.svg" alt="ä¸€ç»´äº’ç›¸å…³è¿ç®—ã€‚é˜´å½±éƒ¨åˆ†æ˜¯ç¬¬ä¸€ä¸ªè¾“å‡ºå…ƒç´ ä»¥åŠç”¨äºè¾“å‡ºè®¡ç®—çš„è¾“å…¥å’Œæ ¸å¼ é‡å…ƒç´ ï¼š"><br>ğŸ· <code>fig_conv1d</code></p><p>å¦‚ :numref: <code>fig_conv1d</code> ä¸­æ‰€ç¤ºï¼Œåœ¨ä¸€ç»´æƒ…å†µä¸‹ï¼Œå·ç§¯çª—å£åœ¨è¾“å…¥å¼ é‡ä¸Šä»å·¦å‘å³æ»‘åŠ¨ã€‚åœ¨æ»‘åŠ¨æœŸé—´ï¼Œå·ç§¯çª—å£ä¸­æŸä¸ªä½ç½®åŒ…å«çš„è¾“å…¥å­å¼ é‡ï¼ˆä¾‹å¦‚ï¼Œ :numref: <code>fig_conv1d</code> ä¸­çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span> å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>ï¼‰å’Œæ ¸å¼ é‡ï¼ˆä¾‹å¦‚ï¼Œ :numref: <code>fig_conv1d</code> ä¸­çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span></span></span></span>ï¼‰æŒ‰å…ƒç´ ç›¸ä¹˜ã€‚è¿™äº›ä¹˜æ³•çš„æ€»å’Œåœ¨è¾“å‡ºå¼ é‡çš„ç›¸åº”ä½ç½®ç»™å‡ºå•ä¸ªæ ‡é‡å€¼ï¼ˆä¾‹å¦‚ï¼Œ :numref: <code>fig_conv1d</code> ä¸­çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>Ã—</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>Ã—</mo><mn>2</mn><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">0\times1+1\times2=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">0</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span></span></span></span>ï¼‰ã€‚</p><p>æˆ‘ä»¬åœ¨ä¸‹é¢çš„ <code>corr1d</code> å‡½æ•°ä¸­å®ç°äº†ä¸€ç»´äº’ç›¸å…³ã€‚ç»™å®šè¾“å…¥å¼ é‡ <code>X</code> å’Œæ ¸å¼ é‡ <code>K</code> ï¼Œå®ƒè¿”å›è¾“å‡ºå¼ é‡ <code>Y</code> ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">corr1d</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> K<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    w <span class="token operator">=</span> K<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    Y <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> w <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>Y<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        Y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">:</span> i <span class="token operator">+</span> w<span class="token punctuation">]</span> <span class="token operator">*</span> K<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> Y</pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä» :numref: <code>fig_conv1d</code> æ„é€ è¾“å…¥å¼ é‡ <code>X</code> å’Œæ ¸å¼ é‡ <code>K</code> æ¥éªŒè¯ä¸Šè¿°ä¸€ç»´äº’ç›¸å…³å®ç°çš„è¾“å‡ºã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>X<span class="token punctuation">,</span> K <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>corr1d<span class="token punctuation">(</span>X<span class="token punctuation">,</span> K<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>tensor([ 2.,  5.,  8., 11., 14., 17.])
</code></pre><p>å¯¹äºä»»ä½•å…·æœ‰å¤šä¸ªé€šé“çš„ä¸€ç»´è¾“å…¥ï¼Œå·ç§¯æ ¸éœ€è¦å…·æœ‰ç›¸åŒæ•°é‡çš„è¾“å…¥é€šé“ã€‚ç„¶åï¼Œå¯¹äºæ¯ä¸ªé€šé“ï¼Œå¯¹è¾“å…¥çš„ä¸€ç»´å¼ é‡å’Œå·ç§¯æ ¸çš„ä¸€ç»´å¼ é‡æ‰§è¡Œäº’ç›¸å…³è¿ç®—ï¼Œå°†æ‰€æœ‰é€šé“ä¸Šçš„ç»“æœç›¸åŠ ä»¥äº§ç”Ÿä¸€ç»´è¾“å‡ºå¼ é‡ã€‚ :numref: <code>fig_conv1d_channel</code> æ¼”ç¤ºäº†å…·æœ‰ 3 ä¸ªè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³æ“ä½œã€‚</p><p><img data-src="/./images/conv1d-channel.svg" alt="å…·æœ‰3ä¸ªè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³è¿ç®—ã€‚é˜´å½±éƒ¨åˆ†æ˜¯ç¬¬ä¸€ä¸ªè¾“å‡ºå…ƒç´ ä»¥åŠç”¨äºè¾“å‡ºè®¡ç®—çš„è¾“å…¥å’Œæ ¸å¼ é‡å…ƒç´ ï¼š"><br>ğŸ· <code>fig_conv1d_channel</code></p><p>æˆ‘ä»¬å¯ä»¥å®ç°å¤šä¸ªè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³è¿ç®—ï¼Œå¹¶åœ¨ :numref: <code>fig_conv1d_channel</code> ä¸­éªŒè¯ç»“æœã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">corr1d_multi_in</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> K<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment"># é¦–å…ˆï¼Œéå† 'X' å’Œ 'K' çš„ç¬¬ 0 ç»´ï¼ˆé€šé“ç»´ï¼‰ã€‚ç„¶åï¼ŒæŠŠå®ƒä»¬åŠ åœ¨ä¸€èµ·</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>corr1d<span class="token punctuation">(</span>x<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span> k <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> K<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>X <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>              <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>              <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>K <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>corr1d_multi_in<span class="token punctuation">(</span>X<span class="token punctuation">,</span> K<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>tensor([ 2.,  8., 14., 20., 26., 32.])
</code></pre><p>æ³¨æ„ï¼Œå¤šè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³ç­‰åŒäºå•è¾“å…¥é€šé“çš„äºŒç»´äº’ç›¸å…³ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œ :numref: <code>fig_conv1d_channel</code> ä¸­çš„å¤šè¾“å…¥é€šé“ä¸€ç»´äº’ç›¸å…³çš„ç­‰ä»·å½¢å¼æ˜¯ :numref: <code>fig_conv1d_2d</code> ä¸­çš„å•è¾“å…¥é€šé“äºŒç»´äº’ç›¸å…³ï¼Œå…¶ä¸­å·ç§¯æ ¸çš„é«˜åº¦å¿…é¡»ä¸è¾“å…¥å¼ é‡çš„é«˜åº¦ç›¸åŒã€‚</p><p><img data-src="/./images/conv1d-2d.svg" alt="å…·æœ‰å•ä¸ªè¾“å…¥é€šé“çš„äºŒç»´äº’ç›¸å…³æ“ä½œã€‚é˜´å½±éƒ¨åˆ†æ˜¯ç¬¬ä¸€ä¸ªè¾“å‡ºå…ƒç´ ä»¥åŠç”¨äºè¾“å‡ºè®¡ç®—çš„è¾“å…¥å’Œå†…æ ¸å¼ é‡å…ƒç´ ï¼š "><br>ğŸ· <code>fig_conv1d_2d</code></p><p>:numref: <code>fig_conv1d</code> å’Œ :numref: <code>fig_conv1d_channel</code> ä¸­çš„è¾“å‡ºéƒ½åªæœ‰ä¸€ä¸ªé€šé“ã€‚ä¸ :numref: <code>subsec_multi-output-channels</code> ä¸­æè¿°çš„å…·æœ‰å¤šä¸ªè¾“å‡ºé€šé“çš„äºŒç»´å·ç§¯ç›¸åŒï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ºä¸€ç»´å·ç§¯æŒ‡å®šå¤šä¸ªè¾“å‡ºé€šé“ã€‚</p><h2 id="æœ€å¤§æ—¶é—´æ±‡èšå±‚"><a class="anchor" href="#æœ€å¤§æ—¶é—´æ±‡èšå±‚">#</a> æœ€å¤§æ—¶é—´æ±‡èšå±‚</h2><p>ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ±‡èšå±‚ä»åºåˆ—è¡¨ç¤ºä¸­æå–æœ€å¤§å€¼ï¼Œä½œä¸ºè·¨æ—¶é—´æ­¥çš„æœ€é‡è¦ç‰¹å¾ã€‚textCNN ä¸­ä½¿ç”¨çš„<em>æœ€å¤§æ—¶é—´æ±‡èšå±‚</em>çš„å·¥ä½œåŸç†ç±»ä¼¼äºä¸€ç»´å…¨å±€æ±‡èš :cite: <code>Collobert.Weston.Bottou.ea.2011</code> ã€‚å¯¹äºæ¯ä¸ªé€šé“åœ¨ä¸åŒæ—¶é—´æ­¥å­˜å‚¨å€¼çš„å¤šé€šé“è¾“å…¥ï¼Œæ¯ä¸ªé€šé“çš„è¾“å‡ºæ˜¯è¯¥é€šé“çš„æœ€å¤§å€¼ã€‚è¯·æ³¨æ„ï¼Œæœ€å¤§æ—¶é—´æ±‡èšå…è®¸åœ¨ä¸åŒé€šé“ä¸Šä½¿ç”¨ä¸åŒæ•°é‡çš„æ—¶é—´æ­¥ã€‚</p><h2 id="textcnnæ¨¡å‹"><a class="anchor" href="#textcnnæ¨¡å‹">#</a> textCNN æ¨¡å‹</h2><p>ä½¿ç”¨ä¸€ç»´å·ç§¯å’Œæœ€å¤§æ—¶é—´æ±‡èšï¼ŒtextCNN æ¨¡å‹å°†å•ä¸ªé¢„è®­ç»ƒçš„è¯å…ƒè¡¨ç¤ºä½œä¸ºè¾“å…¥ï¼Œç„¶åè·å¾—å¹¶è½¬æ¢ç”¨äºä¸‹æ¸¸åº”ç”¨çš„åºåˆ—è¡¨ç¤ºã€‚</p><p>å¯¹äºå…·æœ‰ç”±<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">d</span></span></span></span> ç»´å‘é‡è¡¨ç¤ºçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªè¯å…ƒçš„å•ä¸ªæ–‡æœ¬åºåˆ—ï¼Œè¾“å…¥å¼ é‡çš„å®½åº¦ã€é«˜åº¦å’Œé€šé“æ•°åˆ†åˆ«ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">d</span></span></span></span>ã€‚textCNN æ¨¡å‹å°†è¾“å…¥è½¬æ¢ä¸ºè¾“å‡ºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol><li>å®šä¹‰å¤šä¸ªä¸€ç»´å·ç§¯æ ¸ï¼Œå¹¶åˆ†åˆ«å¯¹è¾“å…¥æ‰§è¡Œå·ç§¯è¿ç®—ã€‚å…·æœ‰ä¸åŒå®½åº¦çš„å·ç§¯æ ¸å¯ä»¥æ•è·ä¸åŒæ•°ç›®çš„ç›¸é‚»è¯å…ƒä¹‹é—´çš„å±€éƒ¨ç‰¹å¾ã€‚</li><li>åœ¨æ‰€æœ‰è¾“å‡ºé€šé“ä¸Šæ‰§è¡Œæœ€å¤§æ—¶é—´æ±‡èšå±‚ï¼Œç„¶åå°†æ‰€æœ‰æ ‡é‡æ±‡èšè¾“å‡ºè¿ç»“ä¸ºå‘é‡ã€‚</li><li>ä½¿ç”¨å…¨è¿æ¥å±‚å°†è¿ç»“åçš„å‘é‡è½¬æ¢ä¸ºè¾“å‡ºç±»åˆ«ã€‚Dropout å¯ä»¥ç”¨æ¥å‡å°‘è¿‡æ‹Ÿåˆã€‚</li></ol><p><img data-src="/./images/textcnn.svg" alt="textCNNçš„æ¨¡å‹æ¶æ„"><br>ğŸ· <code>fig_conv1d_textcnn</code></p><p>:numref: <code>fig_conv1d_textcnn</code> é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­è¯´æ˜äº† textCNN çš„æ¨¡å‹æ¶æ„ã€‚è¾“å…¥æ˜¯å…·æœ‰ 11 ä¸ªè¯å…ƒçš„å¥å­ï¼Œå…¶ä¸­æ¯ä¸ªè¯å…ƒç”± 6 ç»´å‘é‡è¡¨ç¤ºã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå®½åº¦ä¸º 11 çš„ 6 é€šé“è¾“å…¥ã€‚å®šä¹‰ä¸¤ä¸ªå®½åº¦ä¸º 2 å’Œ 4 çš„ä¸€ç»´å·ç§¯æ ¸ï¼Œåˆ†åˆ«å…·æœ‰ 4 ä¸ªå’Œ 5 ä¸ªè¾“å‡ºé€šé“ã€‚å®ƒä»¬äº§ç”Ÿ 4 ä¸ªå®½åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>11</mn><mo>âˆ’</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">11-2+1=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">0</span></span></span></span> çš„è¾“å‡ºé€šé“å’Œ 5 ä¸ªå®½åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>11</mn><mo>âˆ’</mo><mn>4</mn><mo>+</mo><mn>1</mn><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">11-4+1=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">8</span></span></span></span> çš„è¾“å‡ºé€šé“ã€‚å°½ç®¡è¿™ 9 ä¸ªé€šé“çš„å®½åº¦ä¸åŒï¼Œä½†æœ€å¤§æ—¶é—´æ±‡èšå±‚ç»™å‡ºäº†ä¸€ä¸ªè¿ç»“çš„ 9 ç»´å‘é‡ï¼Œè¯¥å‘é‡æœ€ç»ˆè¢«è½¬æ¢ä¸ºç”¨äºäºŒå…ƒæƒ…æ„Ÿé¢„æµ‹çš„ 2 ç»´è¾“å‡ºå‘é‡ã€‚</p><h3 id="å®šä¹‰æ¨¡å‹"><a class="anchor" href="#å®šä¹‰æ¨¡å‹">#</a> å®šä¹‰æ¨¡å‹</h3><p>æˆ‘ä»¬åœ¨ä¸‹é¢çš„ç±»ä¸­å®ç° textCNN æ¨¡å‹ã€‚ä¸ :numref: <code>sec_sentiment_rnn</code> çš„åŒå‘å¾ªç¯ç¥ç»ç½‘ç»œæ¨¡å‹ç›¸æ¯”ï¼Œé™¤äº†ç”¨å·ç§¯å±‚ä»£æ›¿å¾ªç¯ç¥ç»ç½‘ç»œå±‚å¤–ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨äº†ä¸¤ä¸ªåµŒå…¥å±‚ï¼šä¸€ä¸ªæ˜¯å¯è®­ç»ƒæƒé‡ï¼Œå¦ä¸€ä¸ªæ˜¯å›ºå®šæƒé‡ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">TextCNN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> vocab_size<span class="token punctuation">,</span> embed_size<span class="token punctuation">,</span> kernel_sizes<span class="token punctuation">,</span> num_channels<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                 <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token builtin">super</span><span class="token punctuation">(</span>TextCNN<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        self<span class="token punctuation">.</span>embedding <span class="token operator">=</span> nn<span class="token punctuation">.</span>Embedding<span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> embed_size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token comment"># è¿™ä¸ªåµŒå…¥å±‚ä¸éœ€è¦è®­ç»ƒ</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        self<span class="token punctuation">.</span>constant_embedding <span class="token operator">=</span> nn<span class="token punctuation">.</span>Embedding<span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> embed_size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        self<span class="token punctuation">.</span>dropout <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        self<span class="token punctuation">.</span>decoder <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>num_channels<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token comment"># æœ€å¤§æ—¶é—´æ±‡èšå±‚æ²¡æœ‰å‚æ•°ï¼Œå› æ­¤å¯ä»¥å…±äº«æ­¤å®ä¾‹</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        self<span class="token punctuation">.</span>pool <span class="token operator">=</span> nn<span class="token punctuation">.</span>AdaptiveAvgPool1d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        self<span class="token punctuation">.</span>relu <span class="token operator">=</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token comment"># åˆ›å»ºå¤šä¸ªä¸€ç»´å·ç§¯å±‚</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        self<span class="token punctuation">.</span>convs <span class="token operator">=</span> nn<span class="token punctuation">.</span>ModuleList<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">for</span> c<span class="token punctuation">,</span> k <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>num_channels<span class="token punctuation">,</span> kernel_sizes<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            self<span class="token punctuation">.</span>convs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Conv1d<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> embed_size<span class="token punctuation">,</span> c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token comment"># æ²¿ç€å‘é‡ç»´åº¦å°†ä¸¤ä¸ªåµŒå…¥å±‚è¿ç»“èµ·æ¥ï¼Œ</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token comment"># æ¯ä¸ªåµŒå…¥å±‚çš„è¾“å‡ºå½¢çŠ¶éƒ½æ˜¯ï¼ˆæ‰¹é‡å¤§å°ï¼Œè¯å…ƒæ•°é‡ï¼Œè¯å…ƒå‘é‡ç»´åº¦ï¼‰è¿ç»“èµ·æ¥</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        embeddings <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            self<span class="token punctuation">.</span>embedding<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>constant_embedding<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token comment"># æ ¹æ®ä¸€ç»´å·ç§¯å±‚çš„è¾“å…¥æ ¼å¼ï¼Œé‡æ–°æ’åˆ—å¼ é‡ï¼Œä»¥ä¾¿é€šé“ä½œä¸ºç¬¬ 2 ç»´</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        embeddings <span class="token operator">=</span> embeddings<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token comment"># æ¯ä¸ªä¸€ç»´å·ç§¯å±‚åœ¨æœ€å¤§æ—¶é—´æ±‡èšå±‚åˆå¹¶åï¼Œè·å¾—çš„å¼ é‡å½¢çŠ¶æ˜¯ï¼ˆæ‰¹é‡å¤§å°ï¼Œé€šé“æ•°ï¼Œ1ï¼‰</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token comment"># åˆ é™¤æœ€åä¸€ä¸ªç»´åº¦å¹¶æ²¿é€šé“ç»´åº¦è¿ç»“</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        encoding <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            torch<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>self<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>conv<span class="token punctuation">(</span>embeddings<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token keyword">for</span> conv <span class="token keyword">in</span> self<span class="token punctuation">.</span>convs<span class="token punctuation">]</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        outputs <span class="token operator">=</span> self<span class="token punctuation">.</span>decoder<span class="token punctuation">(</span>self<span class="token punctuation">.</span>dropout<span class="token punctuation">(</span>encoding<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">return</span> outputs</pre></td></tr></table></figure><p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª textCNN å®ä¾‹ã€‚å®ƒæœ‰ 3 ä¸ªå·ç§¯å±‚ï¼Œå·ç§¯æ ¸å®½åº¦åˆ†åˆ«ä¸º 3ã€4 å’Œ 5ï¼Œå‡æœ‰ 100 ä¸ªè¾“å‡ºé€šé“ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>embed_size<span class="token punctuation">,</span> kernel_sizes<span class="token punctuation">,</span> nums_channels <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>devices <span class="token operator">=</span> d2l<span class="token punctuation">.</span>try_all_gpus<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>net <span class="token operator">=</span> TextCNN<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>vocab<span class="token punctuation">)</span><span class="token punctuation">,</span> embed_size<span class="token punctuation">,</span> kernel_sizes<span class="token punctuation">,</span> nums_channels<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">init_weights</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">,</span> nn<span class="token punctuation">.</span>Conv1d<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>xavier_uniform_<span class="token punctuation">(</span>m<span class="token punctuation">.</span>weight<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>net<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>init_weights<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="åŠ è½½é¢„è®­ç»ƒè¯å‘é‡"><a class="anchor" href="#åŠ è½½é¢„è®­ç»ƒè¯å‘é‡">#</a> åŠ è½½é¢„è®­ç»ƒè¯å‘é‡</h3><p>ä¸ :numref: <code>sec_sentiment_rnn</code> ç›¸åŒï¼Œæˆ‘ä»¬åŠ è½½é¢„è®­ç»ƒçš„ 100 ç»´ GloVe åµŒå…¥ä½œä¸ºåˆå§‹åŒ–çš„è¯å…ƒè¡¨ç¤ºã€‚è¿™äº›è¯å…ƒè¡¨ç¤ºï¼ˆåµŒå…¥æƒé‡ï¼‰åœ¨ <code>embedding</code> ä¸­å°†è¢«è®­ç»ƒï¼Œåœ¨ <code>constant_embedding</code> ä¸­å°†è¢«å›ºå®šã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>glove_embedding <span class="token operator">=</span> d2l<span class="token punctuation">.</span>TokenEmbedding<span class="token punctuation">(</span><span class="token string">'glove.6b.100d'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>embeds <span class="token operator">=</span> glove_embedding<span class="token punctuation">[</span>vocab<span class="token punctuation">.</span>idx_to_token<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>net<span class="token punctuation">.</span>embedding<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>data<span class="token punctuation">.</span>copy_<span class="token punctuation">(</span>embeds<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>net<span class="token punctuation">.</span>constant_embedding<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>data<span class="token punctuation">.</span>copy_<span class="token punctuation">(</span>embeds<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>net<span class="token punctuation">.</span>constant_embedding<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">False</span></pre></td></tr></table></figure><h3 id="è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹"><a class="anchor" href="#è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹">#</a> è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹</h3><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥è®­ç»ƒ textCNN æ¨¡å‹è¿›è¡Œæƒ…æ„Ÿåˆ†æã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>lr<span class="token punctuation">,</span> num_epochs <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">,</span> <span class="token number">5</span></pre></td></tr><tr><td data-num="2"></td><td><pre>trainer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span>lr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>loss <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span>reduction<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>d2l<span class="token punctuation">.</span>train_ch13<span class="token punctuation">(</span>net<span class="token punctuation">,</span> train_iter<span class="token punctuation">,</span> test_iter<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> trainer<span class="token punctuation">,</span> num_epochs<span class="token punctuation">,</span> devices<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>loss 0.065, train acc 0.979, test acc 0.860
3418.5 examples/sec on [device(type='cuda', index=0), device(type='cuda', index=1)]
</code></pre><p><img data-src="/sentiment-analysis-cnn_files/sentiment-analysis-cnn_15_1.svg" alt="svg"></p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹æ¥é¢„æµ‹ä¸¤ä¸ªç®€å•å¥å­çš„æƒ…æ„Ÿã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>d2l<span class="token punctuation">.</span>predict_sentiment<span class="token punctuation">(</span>net<span class="token punctuation">,</span> vocab<span class="token punctuation">,</span> <span class="token string">'this movie is so great'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>'positive'
</code></pre><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>d2l<span class="token punctuation">.</span>predict_sentiment<span class="token punctuation">(</span>net<span class="token punctuation">,</span> vocab<span class="token punctuation">,</span> <span class="token string">'this movie is so bad'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>'negative'
</code></pre><h2 id="å°ç»“"><a class="anchor" href="#å°ç»“">#</a> å°ç»“</h2><ul><li>ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œå¯ä»¥å¤„ç†æ–‡æœ¬ä¸­çš„å±€éƒ¨ç‰¹å¾ï¼Œä¾‹å¦‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> å…ƒè¯­æ³•ã€‚</li><li>å¤šè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³ç­‰ä»·äºå•è¾“å…¥é€šé“çš„äºŒç»´äº’ç›¸å…³ã€‚</li><li>æœ€å¤§æ—¶é—´æ±‡èšå±‚å…è®¸åœ¨ä¸åŒé€šé“ä¸Šä½¿ç”¨ä¸åŒæ•°é‡çš„æ—¶é—´æ­¥é•¿ã€‚</li><li>textCNN æ¨¡å‹ä½¿ç”¨ä¸€ç»´å·ç§¯å±‚å’Œæœ€å¤§æ—¶é—´æ±‡èšå±‚å°†å•ä¸ªè¯å…ƒè¡¨ç¤ºè½¬æ¢ä¸ºä¸‹æ¸¸åº”ç”¨è¾“å‡ºã€‚</li></ul><h2 id="ç»ƒä¹ "><a class="anchor" href="#ç»ƒä¹ ">#</a> ç»ƒä¹ </h2><ol><li>è°ƒæ•´è¶…å‚æ•°ï¼Œå¹¶æ¯”è¾ƒ :numref: <code>sec_sentiment_rnn</code> ä¸­ç”¨äºæƒ…æ„Ÿåˆ†æçš„æ¶æ„å’Œæœ¬èŠ‚ä¸­ç”¨äºæƒ…æ„Ÿåˆ†æçš„æ¶æ„ï¼Œä¾‹å¦‚åœ¨åˆ†ç±»ç²¾åº¦å’Œè®¡ç®—æ•ˆç‡æ–¹é¢ã€‚</li><li>è¯·è¯•ç€ç”¨ :numref: <code>sec_sentiment_rnn</code> ç»ƒä¹ ä¸­ä»‹ç»çš„æ–¹æ³•è¿›ä¸€æ­¥æé«˜æ¨¡å‹çš„åˆ†ç±»ç²¾åº¦ã€‚</li><li>åœ¨è¾“å…¥è¡¨ç¤ºä¸­æ·»åŠ ä½ç½®ç¼–ç ã€‚å®ƒæ˜¯å¦æé«˜äº†åˆ†ç±»çš„ç²¾åº¦ï¼Ÿ</li></ol><p><span class="exturl" data-url="aHR0cHM6Ly9kaXNjdXNzLmQybC5haS90LzU3MjA=">Discussions</span></p><div class="tags"><a href="/tags/chapter-natural-language-processing-applications/" rel="tag"><i class="ic i-tag"></i> chapter_natural-language-processing-applications</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-03-04 13:38:25" itemprop="dateModified" datetime="2023-03-04T13:38:25+08:00">2023-03-04</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="yuan å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="yuan æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div><div><img data-src="/images/paypal.png" alt="yuan è´å®"><p>è´å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>yuan <i class="ic i-at"><em>@</em></i>yuan</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/sentiment-analysis-cnn/" title="sentiment-analysis-cnn">https://huang-junyuan.github.io/2023/02/15/ai/pytorchæ·±åº¦å­¦ä¹ /chapter_natural-language-processing-applications/sentiment-analysis-cnn/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/adam/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;zkz0&#x2F;image&#x2F;raw&#x2F;master&#x2F;img&#x2F;img(51).webp" title="adam"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> chapter_optimization</span><h3>adam</h3></a></div><div class="item right"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/adagrad/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;zkz0&#x2F;image&#x2F;raw&#x2F;master&#x2F;img&#x2F;img(96).webp" title="adagrad"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> chapter_optimization</span><h3>adagrad</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90%E4%BD%BF%E7%94%A8%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-number">1.</span> <span class="toc-text">æƒ…æ„Ÿåˆ†æï¼šä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E7%BB%B4%E5%8D%B7%E7%A7%AF"><span class="toc-number">1.1.</span> <span class="toc-text">ä¸€ç»´å·ç§¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E6%97%B6%E9%97%B4%E6%B1%87%E8%81%9A%E5%B1%82"><span class="toc-number">1.2.</span> <span class="toc-text">æœ€å¤§æ—¶é—´æ±‡èšå±‚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#textcnn%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">textCNN æ¨¡å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.1.</span> <span class="toc-text">å®šä¹‰æ¨¡å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%8D%E5%90%91%E9%87%8F"><span class="toc-number">1.3.2.</span> <span class="toc-text">åŠ è½½é¢„è®­ç»ƒè¯å‘é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83%E5%92%8C%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">å°ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">1.5.</span> <span class="toc-text">ç»ƒä¹ </span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/index/" rel="bookmark" title="index">index</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/finetuning-bert/" rel="bookmark" title="finetuning-bert">finetuning-bert</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/natural-language-inference-and-dataset/" rel="bookmark" title="natural-language-inference-and-dataset">natural-language-inference-and-dataset</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/natural-language-inference-attention/" rel="bookmark" title="natural-language-inference-attention">natural-language-inference-attention</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/sentiment-analysis-and-dataset/" rel="bookmark" title="sentiment-analysis-and-dataset">sentiment-analysis-and-dataset</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/natural-language-inference-bert/" rel="bookmark" title="natural-language-inference-bert">natural-language-inference-bert</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/sentiment-analysis-rnn/" rel="bookmark" title="sentiment-analysis-rnn">sentiment-analysis-rnn</a></li><li class="active"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/sentiment-analysis-cnn/" rel="bookmark" title="sentiment-analysis-cnn">sentiment-analysis-cnn</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="yuan" data-src="/images/avatar.jpg"><p class="name" itemprop="name">yuan</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">410</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">72</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">61</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><span class="exturl item email" data-url="bWFpbHRvOjIwODM2MzU1MjVAcXEuY29t" title="mailto:2083635525@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>å‹é”</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>é“¾æ¥</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/adam/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/adagrad/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-optimization/" title="åˆ†ç±»äº chapter_optimization">chapter_optimization</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/minibatch-sgd/" title="minibatch-sgd">minibatch-sgd</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-linear-networks/" title="åˆ†ç±»äº chapter_linear-networks">chapter_linear-networks</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_linear-networks/image-classification-dataset/" title="image-classification-dataset">image-classification-dataset</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Python/" title="åˆ†ç±»äº Python">Python</a></div><span><a href="/2022/09/23/language/python/%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/" title="ç¨‹åºæ‰§è¡Œæµç¨‹-python">ç¨‹åºæ‰§è¡Œæµç¨‹-python</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/24/frontend/javascript/JavaScript%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/25/computer-science/base/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/%E8%81%8A%E5%A4%A9%E8%87%AA%E4%B9%A0%E5%AE%A4/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/cv/" title="åˆ†ç±»äº cv">cv</a></div><span><a href="/2022/08/24/ai/cv/face-alignment%EF%BC%9Aface-alignment%E5%BA%93%E7%9A%84%E7%AE%80%E4%BB%8B%E3%80%81%E5%AE%89%E8%A3%85%E3%80%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" title="face_alignmentï¼šface_alignmentåº“çš„ç®€ä»‹ã€å®‰è£…ã€ä½¿ç”¨æ–¹æ³•">face_alignmentï¼šface_alignmentåº“çš„ç®€ä»‹ã€å®‰è£…ã€ä½¿ç”¨æ–¹æ³•</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/frontend/" title="åˆ†ç±»äº å‰ç«¯">å‰ç«¯</a></div><span><a href="/2022/08/09/frontend/base/TypeScript/" title="TypeScript">TypeScript</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/backend/" title="åˆ†ç±»äº åç«¯">åç«¯</a> <i class="ic i-angle-right"></i> <a href="/categories/backend/MyBatisPlus/" title="åˆ†ç±»äº MyBatisPlus">MyBatisPlus</a></div><span><a href="/2022/11/12/backend/Mybatisplus/MyBatisPlus/" title="MyBatisPlus">MyBatisPlus</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/25/computer-science/%E6%AF%94%E8%B5%9B/%E9%AB%98%E7%BA%A7%E8%BD%AF%E8%80%83/%E9%80%89%E6%8B%A9%E9%A2%98/%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-multilayer-perceptrons/" title="åˆ†ç±»äº chapter_multilayer-perceptrons">chapter_multilayer-perceptrons</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_multilayer-perceptrons/numerical-stability-and-init/" title="numerical-stability-and-init">numerical-stability-and-init</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 â€“ <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">yuan @ Mi Manchi</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">2.9m å­—</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">43:49</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/02/15/ai/pytorchæ·±åº¦å­¦ä¹ /chapter_natural-language-processing-applications/sentiment-analysis-cnn/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>