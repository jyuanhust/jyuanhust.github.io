<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="yuan" href="https://huang-junyuan.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="yuan" href="https://huang-junyuan.github.io/atom.xml"><link rel="alternate" type="application/json" title="yuan" href="https://huang-junyuan.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="chapter_natural-language-processing-pretraining"><link rel="canonical" href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/subword-embedding/"><title>subword-embedding - chapter_natural-language-processing-pretraining - pytorchæ·±åº¦å­¦ä¹  - ai | Mi Manchi = yuan = Whatever is worth doing at all is worth doing well</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">subword-embedding</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2023-02-15 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2023-02-15T00:00:00+08:00">2023-02-15</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>4.7k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>4 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Mi Manchi</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(96).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(72).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(68).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(22).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(55).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(26).webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/" itemprop="item" rel="index" title="åˆ†ç±»äº ai"><span itemprop="name">ai</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="item" rel="index" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ "><span itemprop="name">pytorchæ·±åº¦å­¦ä¹ </span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-natural-language-processing-pretraining/" itemprop="item" rel="index" title="åˆ†ç±»äº chapter_natural-language-processing-pretraining"><span itemprop="name">chapter_natural-language-processing-pretraining</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/subword-embedding/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="yuan"><meta itemprop="description" content="Whatever is worth doing at all is worth doing well, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="yuan"></span><div class="body md" itemprop="articleBody"><h1 id="å­è¯åµŒå…¥"><a class="anchor" href="#å­è¯åµŒå…¥">#</a> å­è¯åµŒå…¥</h1><p>ğŸ· <code>sec_fasttext</code></p><p>åœ¨è‹±è¯­ä¸­ï¼Œâ€œhelpsâ€â€œhelpedâ€ å’Œ â€œhelpingâ€ ç­‰å•è¯éƒ½æ˜¯åŒä¸€ä¸ªè¯ â€œhelpâ€ çš„å˜å½¢å½¢å¼ã€‚â€œdogâ€ å’Œ â€œdogsâ€ ä¹‹é—´çš„å…³ç³»ä¸ â€œcatâ€ å’Œ â€œcatsâ€ ä¹‹é—´çš„å…³ç³»ç›¸åŒï¼Œâ€œboyâ€ å’Œ â€œboyfriendâ€ ä¹‹é—´çš„å…³ç³»ä¸ â€œgirlâ€ å’Œ â€œgirlfriendâ€ ä¹‹é—´çš„å…³ç³»ç›¸åŒã€‚åœ¨æ³•è¯­å’Œè¥¿ç­ç‰™è¯­ç­‰å…¶ä»–è¯­è¨€ä¸­ï¼Œè®¸å¤šåŠ¨è¯æœ‰ 40 å¤šç§å˜å½¢å½¢å¼ï¼Œè€Œåœ¨èŠ¬å…°è¯­ä¸­ï¼Œåè¯æœ€å¤šå¯èƒ½æœ‰ 15 ç§å˜å½¢ã€‚åœ¨è¯­è¨€å­¦ä¸­ï¼Œå½¢æ€å­¦ç ”ç©¶å•è¯å½¢æˆå’Œè¯æ±‡å…³ç³»ã€‚ä½†æ˜¯ï¼Œword2vec å’Œ GloVe éƒ½æ²¡æœ‰å¯¹è¯çš„å†…éƒ¨ç»“æ„è¿›è¡Œæ¢è®¨ã€‚</p><h2 id="fasttextæ¨¡å‹"><a class="anchor" href="#fasttextæ¨¡å‹">#</a> fastText æ¨¡å‹</h2><p>å›æƒ³ä¸€ä¸‹è¯åœ¨ word2vec ä¸­æ˜¯å¦‚ä½•è¡¨ç¤ºçš„ã€‚åœ¨è·³å…ƒæ¨¡å‹å’Œè¿ç»­è¯è¢‹æ¨¡å‹ä¸­ï¼ŒåŒä¸€è¯çš„ä¸åŒå˜å½¢å½¢å¼ç›´æ¥ç”±ä¸åŒçš„å‘é‡è¡¨ç¤ºï¼Œä¸éœ€è¦å…±äº«å‚æ•°ã€‚ä¸ºäº†ä½¿ç”¨å½¢æ€ä¿¡æ¯ï¼Œ<em>fastText æ¨¡å‹</em>æå‡ºäº†ä¸€ç§<em>å­è¯åµŒå…¥</em>æ–¹æ³•ï¼Œå…¶ä¸­å­è¯æ˜¯ä¸€ä¸ªå­—ç¬¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span>-gram :cite: <code>Bojanowski.Grave.Joulin.ea.2017</code> ã€‚fastText å¯ä»¥è¢«è®¤ä¸ºæ˜¯å­è¯çº§è·³å…ƒæ¨¡å‹ï¼Œè€Œéå­¦ä¹ è¯çº§å‘é‡è¡¨ç¤ºï¼Œå…¶ä¸­æ¯ä¸ª<em>ä¸­å¿ƒè¯</em>ç”±å…¶å­è¯çº§å‘é‡ä¹‹å’Œè¡¨ç¤ºã€‚</p><p>è®©æˆ‘ä»¬æ¥è¯´æ˜å¦‚ä½•ä»¥å•è¯ â€œwhereâ€ ä¸ºä¾‹è·å¾— fastText ä¸­æ¯ä¸ªä¸­å¿ƒè¯çš„å­è¯ã€‚é¦–å…ˆï¼Œåœ¨è¯çš„å¼€å¤´å’Œæœ«å°¾æ·»åŠ ç‰¹æ®Šå­—ç¬¦ â€œ&lt;â€ å’Œ â€œ&gt;â€ï¼Œä»¥å°†å‰ç¼€å’Œåç¼€ä¸å…¶ä»–å­è¯åŒºåˆ†å¼€æ¥ã€‚<br>ç„¶åï¼Œä»è¯ä¸­æå–å­—ç¬¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span>-gramã€‚<br>ä¾‹å¦‚ï¼Œå€¼<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">n=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span></span></span></span> æ—¶ï¼Œæˆ‘ä»¬å°†è·å¾—é•¿åº¦ä¸º 3 çš„æ‰€æœ‰å­è¯ï¼š<br>â€œ&lt;whâ€â€œwheâ€â€œherâ€â€œereâ€â€œre&gt;â€ å’Œç‰¹æ®Šå­è¯ â€œ&lt;where&gt;â€ã€‚</p><p>åœ¨ fastText ä¸­ï¼Œå¯¹äºä»»æ„è¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span>ï¼Œç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">G</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{G}_w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:.0593em">G</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºå…¶é•¿åº¦åœ¨ 3 å’Œ 6 ä¹‹é—´çš„æ‰€æœ‰å­è¯ä¸å…¶ç‰¹æ®Šå­è¯çš„å¹¶é›†ã€‚è¯è¡¨æ˜¯æ‰€æœ‰è¯çš„å­è¯çš„é›†åˆã€‚å‡è®¾<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">z</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{z}_g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.730548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> æ˜¯è¯å…¸ä¸­çš„å­è¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span></span></span></span> çš„å‘é‡ï¼Œåˆ™è·³å…ƒæ¨¡å‹ä¸­ä½œä¸ºä¸­å¿ƒè¯çš„è¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span> çš„å‘é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">v</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{v}_w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> æ˜¯å…¶å­è¯å‘é‡çš„å’Œï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">v</mi><mi>w</mi></msub><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>g</mi><mo>âˆˆ</mo><msub><mi mathvariant="script">G</mi><mi>w</mi></msub></mrow></munder><msub><mi mathvariant="bold">z</mi><mi>g</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}_w = \sum_{g\in\mathcal{G}_w} \mathbf{z}_g.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.480449em;vertical-align:-1.430444em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em"><span style="top:-1.8556639999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:.0593em">G</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285719em"><span style="top:-2.357em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.430444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord"><span class="mord mathbf">z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></p><p>fastText çš„å…¶ä½™éƒ¨åˆ†ä¸è·³å…ƒæ¨¡å‹ç›¸åŒã€‚ä¸è·³å…ƒæ¨¡å‹ç›¸æ¯”ï¼ŒfastText çš„è¯é‡æ›´å¤§ï¼Œæ¨¡å‹å‚æ•°ä¹Ÿæ›´å¤šã€‚æ­¤å¤–ï¼Œä¸ºäº†è®¡ç®—ä¸€ä¸ªè¯çš„è¡¨ç¤ºï¼Œå®ƒçš„æ‰€æœ‰å­è¯å‘é‡éƒ½å¿…é¡»æ±‚å’Œï¼Œè¿™å¯¼è‡´äº†æ›´é«˜çš„è®¡ç®—å¤æ‚åº¦ã€‚ç„¶è€Œï¼Œç”±äºå…·æœ‰ç›¸ä¼¼ç»“æ„çš„è¯ä¹‹é—´å…±äº«æ¥è‡ªå­è¯çš„å‚æ•°ï¼Œç½•è§è¯ç”šè‡³è¯è¡¨å¤–çš„è¯åœ¨ fastText ä¸­å¯èƒ½è·å¾—æ›´å¥½çš„å‘é‡è¡¨ç¤ºã€‚</p><h2 id="å­—èŠ‚å¯¹ç¼–ç byte-pair-encoding"><a class="anchor" href="#å­—èŠ‚å¯¹ç¼–ç byte-pair-encoding">#</a> å­—èŠ‚å¯¹ç¼–ç ï¼ˆByte Pair Encodingï¼‰</h2><p>ğŸ· <code>subsec_Byte_Pair_Encoding</code></p><p>åœ¨ fastText ä¸­ï¼Œæ‰€æœ‰æå–çš„å­è¯éƒ½å¿…é¡»æ˜¯æŒ‡å®šçš„é•¿åº¦ï¼Œä¾‹å¦‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span></span></span></span> åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">6</span></span></span></span>ï¼Œå› æ­¤è¯è¡¨å¤§å°ä¸èƒ½é¢„å®šä¹‰ã€‚ä¸ºäº†åœ¨å›ºå®šå¤§å°çš„è¯è¡¨ä¸­å…è®¸å¯å˜é•¿åº¦çš„å­è¯ï¼Œæˆ‘ä»¬å¯ä»¥åº”ç”¨ä¸€ç§ç§°ä¸º<em>å­—èŠ‚å¯¹ç¼–ç </em>ï¼ˆByte Pair Encodingï¼ŒBPEï¼‰çš„å‹ç¼©ç®—æ³•æ¥æå–å­è¯ :cite: <code>Sennrich.Haddow.Birch.2015</code> ã€‚</p><p>å­—èŠ‚å¯¹ç¼–ç æ‰§è¡Œè®­ç»ƒæ•°æ®é›†çš„ç»Ÿè®¡åˆ†æï¼Œä»¥å‘ç°å•è¯å†…çš„å…¬å…±ç¬¦å·ï¼Œè¯¸å¦‚ä»»æ„é•¿åº¦çš„è¿ç»­å­—ç¬¦ã€‚ä»é•¿åº¦ä¸º 1 çš„ç¬¦å·å¼€å§‹ï¼Œå­—èŠ‚å¯¹ç¼–ç è¿­ä»£åœ°åˆå¹¶æœ€é¢‘ç¹çš„è¿ç»­ç¬¦å·å¯¹ä»¥äº§ç”Ÿæ–°çš„æ›´é•¿çš„ç¬¦å·ã€‚è¯·æ³¨æ„ï¼Œä¸ºæé«˜æ•ˆç‡ï¼Œä¸è€ƒè™‘è·¨è¶Šå•è¯è¾¹ç•Œçš„å¯¹ã€‚æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åƒå­è¯è¿™æ ·çš„ç¬¦å·æ¥åˆ‡åˆ†å•è¯ã€‚å­—èŠ‚å¯¹ç¼–ç åŠå…¶å˜ä½“å·²ç»ç”¨äºè¯¸å¦‚ GPT-2 :cite: <code>Radford.Wu.Child.ea.2019</code> å’Œ RoBERTa :cite: <code>Liu.Ott.Goyal.ea.2019</code> ç­‰è‡ªç„¶è¯­è¨€å¤„ç†é¢„è®­ç»ƒæ¨¡å‹ä¸­çš„è¾“å…¥è¡¨ç¤ºã€‚åœ¨ä¸‹é¢ï¼Œæˆ‘ä»¬å°†è¯´æ˜å­—èŠ‚å¯¹ç¼–ç æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç¬¦å·è¯è¡¨åˆå§‹åŒ–ä¸ºæ‰€æœ‰è‹±æ–‡å°å†™å­—ç¬¦ã€ç‰¹æ®Šçš„è¯å°¾ç¬¦å· <code>'_'</code> å’Œç‰¹æ®Šçš„æœªçŸ¥ç¬¦å· <code>'[UNK]'</code> ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> collections</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>symbols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">,</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'j'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>           <span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token string">'q'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">'t'</span><span class="token punctuation">,</span> <span class="token string">'u'</span><span class="token punctuation">,</span> <span class="token string">'v'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>           <span class="token string">'_'</span><span class="token punctuation">,</span> <span class="token string">'[UNK]'</span><span class="token punctuation">]</span></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘ä»¬ä¸è€ƒè™‘è·¨è¶Šè¯è¾¹ç•Œçš„ç¬¦å·å¯¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå­—å…¸ <code>raw_token_freqs</code> å°†è¯æ˜ å°„åˆ°æ•°æ®é›†ä¸­çš„é¢‘ç‡ï¼ˆå‡ºç°æ¬¡æ•°ï¼‰ã€‚æ³¨æ„ï¼Œç‰¹æ®Šç¬¦å· <code>'_'</code> è¢«é™„åŠ åˆ°æ¯ä¸ªè¯çš„å°¾éƒ¨ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å®¹æ˜“åœ°ä»è¾“å‡ºç¬¦å·åºåˆ—ï¼ˆä¾‹å¦‚ï¼Œâ€œa_all er_manâ€ï¼‰æ¢å¤å•è¯åºåˆ—ï¼ˆä¾‹å¦‚ï¼Œâ€œa_all er_manâ€ï¼‰ã€‚ç”±äºæˆ‘ä»¬ä»…ä»å•ä¸ªå­—ç¬¦å’Œç‰¹æ®Šç¬¦å·çš„è¯å¼€å§‹åˆå¹¶å¤„ç†ï¼Œæ‰€ä»¥åœ¨æ¯ä¸ªè¯ï¼ˆè¯å…¸ <code>token_freqs</code> çš„é”®ï¼‰å†…çš„æ¯å¯¹è¿ç»­å­—ç¬¦ä¹‹é—´æ’å…¥ç©ºæ ¼ã€‚æ¢å¥è¯è¯´ï¼Œç©ºæ ¼æ˜¯è¯ä¸­ç¬¦å·ä¹‹é—´çš„åˆ†éš”ç¬¦ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>raw_token_freqs <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'fast_'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'faster_'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'tall_'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'taller_'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>token_freqs <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> token<span class="token punctuation">,</span> freq <span class="token keyword">in</span> raw_token_freqs<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    token_freqs<span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> raw_token_freqs<span class="token punctuation">[</span>token<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>token_freqs</pre></td></tr></table></figure><pre><code>&#123;'f a s t _': 4, 'f a s t e r _': 3, 't a l l _': 5, 't a l l e r _': 4&#125;
</code></pre><p>æˆ‘ä»¬å®šä¹‰ä»¥ä¸‹ <code>get_max_freq_pair</code> å‡½æ•°ï¼Œå…¶è¿”å›è¯å†…æœ€é¢‘ç¹çš„è¿ç»­ç¬¦å·å¯¹ï¼Œå…¶ä¸­è¯æ¥è‡ªè¾“å…¥è¯å…¸ <code>token_freqs</code> çš„é”®ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_max_freq_pair</span><span class="token punctuation">(</span>token_freqs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    pairs <span class="token operator">=</span> collections<span class="token punctuation">.</span>defaultdict<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">for</span> token<span class="token punctuation">,</span> freq <span class="token keyword">in</span> token_freqs<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        symbols <span class="token operator">=</span> token<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>symbols<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            <span class="token comment"># â€œpairsâ€ çš„é”®æ˜¯ä¸¤ä¸ªè¿ç»­ç¬¦å·çš„å…ƒç»„</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            pairs<span class="token punctuation">[</span>symbols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> symbols<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> freq</pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">max</span><span class="token punctuation">(</span>pairs<span class="token punctuation">,</span> key<span class="token operator">=</span>pairs<span class="token punctuation">.</span>get<span class="token punctuation">)</span>  <span class="token comment"># å…·æœ‰æœ€å¤§å€¼çš„ â€œpairsâ€ é”®</span></pre></td></tr></table></figure><p>ä½œä¸ºåŸºäºè¿ç»­ç¬¦å·é¢‘ç‡çš„è´ªå¿ƒæ–¹æ³•ï¼Œå­—èŠ‚å¯¹ç¼–ç å°†ä½¿ç”¨ä»¥ä¸‹ <code>merge_symbols</code> å‡½æ•°æ¥åˆå¹¶æœ€é¢‘ç¹çš„è¿ç»­ç¬¦å·å¯¹ä»¥äº§ç”Ÿæ–°ç¬¦å·ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">merge_symbols</span><span class="token punctuation">(</span>max_freq_pair<span class="token punctuation">,</span> token_freqs<span class="token punctuation">,</span> symbols<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    symbols<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>max_freq_pair<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    new_token_freqs <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">for</span> token<span class="token punctuation">,</span> freq <span class="token keyword">in</span> token_freqs<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        new_token <span class="token operator">=</span> token<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>max_freq_pair<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>                                  <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>max_freq_pair<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        new_token_freqs<span class="token punctuation">[</span>new_token<span class="token punctuation">]</span> <span class="token operator">=</span> token_freqs<span class="token punctuation">[</span>token<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> new_token_freqs</pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯¹è¯å…¸ <code>token_freqs</code> çš„é”®è¿­ä»£åœ°æ‰§è¡Œå­—èŠ‚å¯¹ç¼–ç ç®—æ³•ã€‚åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œæœ€é¢‘ç¹çš„è¿ç»­ç¬¦å·å¯¹æ˜¯ <code>'t'</code> å’Œ <code>'a'</code> ï¼Œå› æ­¤å­—èŠ‚å¯¹ç¼–ç å°†å®ƒä»¬åˆå¹¶ä»¥äº§ç”Ÿæ–°ç¬¦å· <code>'ta'</code> ã€‚åœ¨ç¬¬äºŒæ¬¡è¿­ä»£ä¸­ï¼Œå­—èŠ‚å¯¹ç¼–ç ç»§ç»­åˆå¹¶ <code>'ta'</code> å’Œ <code>'l'</code> ä»¥äº§ç”Ÿå¦ä¸€ä¸ªæ–°ç¬¦å· <code>'tal'</code> ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>num_merges <span class="token operator">=</span> <span class="token number">10</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_merges<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    max_freq_pair <span class="token operator">=</span> get_max_freq_pair<span class="token punctuation">(</span>token_freqs<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    token_freqs <span class="token operator">=</span> merge_symbols<span class="token punctuation">(</span>max_freq_pair<span class="token punctuation">,</span> token_freqs<span class="token punctuation">,</span> symbols<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'åˆå¹¶# </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">&#125;</span></span><span class="token string">:'</span></span><span class="token punctuation">,</span>max_freq_pair<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>åˆå¹¶# 1: ('t', 'a')
åˆå¹¶# 2: ('ta', 'l')
åˆå¹¶# 3: ('tal', 'l')
åˆå¹¶# 4: ('f', 'a')
åˆå¹¶# 5: ('fa', 's')
åˆå¹¶# 6: ('fas', 't')
åˆå¹¶# 7: ('e', 'r')
åˆå¹¶# 8: ('er', '_')
åˆå¹¶# 9: ('tall', '_')
åˆå¹¶# 10: ('fast', '_')
</code></pre><p>åœ¨å­—èŠ‚å¯¹ç¼–ç çš„ 10 æ¬¡è¿­ä»£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ—è¡¨ <code>symbols</code> ç°åœ¨åˆåŒ…å« 10 ä¸ªä»å…¶ä»–ç¬¦å·è¿­ä»£åˆå¹¶è€Œæ¥çš„ç¬¦å·ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>symbols<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '_', '[UNK]', 'ta', 'tal', 'tall', 'fa', 'fas', 'fast', 'er', 'er_', 'tall_', 'fast_']
</code></pre><p>å¯¹äºåœ¨è¯å…¸ <code>raw_token_freqs</code> çš„é”®ä¸­æŒ‡å®šçš„åŒä¸€æ•°æ®é›†ï¼Œä½œä¸ºå­—èŠ‚å¯¹ç¼–ç ç®—æ³•çš„ç»“æœï¼Œæ•°æ®é›†ä¸­çš„æ¯ä¸ªè¯ç°åœ¨è¢«å­è¯ â€œfast_â€â€œfastâ€â€œer_â€â€œtall_â€ å’Œ â€œtallâ€ åˆ†å‰²ã€‚ä¾‹å¦‚ï¼Œå•è¯ â€œfast er_â€ å’Œ â€œtall er_â€ åˆ†åˆ«è¢«åˆ†å‰²ä¸º â€œfast er_â€ å’Œ â€œtall er_â€ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>token_freqs<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>['fast_', 'fast er_', 'tall_', 'tall er_']
</code></pre><p>è¯·æ³¨æ„ï¼Œå­—èŠ‚å¯¹ç¼–ç çš„ç»“æœå–å†³äºæ­£åœ¨ä½¿ç”¨çš„æ•°æ®é›†ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä»ä¸€ä¸ªæ•°æ®é›†å­¦ä¹ çš„å­è¯æ¥åˆ‡åˆ†å¦ä¸€ä¸ªæ•°æ®é›†çš„å•è¯ã€‚ä½œä¸ºä¸€ç§è´ªå¿ƒæ–¹æ³•ï¼Œä¸‹é¢çš„ <code>segment_BPE</code> å‡½æ•°å°è¯•å°†å•è¯ä»è¾“å…¥å‚æ•° <code>symbols</code> åˆ†æˆå¯èƒ½æœ€é•¿çš„å­è¯ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">segment_BPE</span><span class="token punctuation">(</span>tokens<span class="token punctuation">,</span> symbols<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    outputs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">for</span> token <span class="token keyword">in</span> tokens<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        start<span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        cur_output <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token comment"># å…·æœ‰ç¬¦å·ä¸­å¯èƒ½æœ€é•¿å­å­—çš„è¯å…ƒæ®µ</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">while</span> start <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token keyword">and</span> start <span class="token operator">&lt;</span> end<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token keyword">if</span> token<span class="token punctuation">[</span>start<span class="token punctuation">:</span> end<span class="token punctuation">]</span> <span class="token keyword">in</span> symbols<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>                cur_output<span class="token punctuation">.</span>append<span class="token punctuation">(</span>token<span class="token punctuation">[</span>start<span class="token punctuation">:</span> end<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>                start <span class="token operator">=</span> end</pre></td></tr><tr><td data-num="11"></td><td><pre>                end <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                end <span class="token operator">-=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">if</span> start <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            cur_output<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'[UNK]'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        outputs<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>cur_output<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">return</span> outputs</pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨åˆ—è¡¨ <code>symbols</code> ä¸­çš„å­è¯ï¼ˆä»å‰é¢æåˆ°çš„æ•°æ®é›†å­¦ä¹ ï¼‰æ¥è¡¨ç¤ºå¦ä¸€ä¸ªæ•°æ®é›†çš„ <code>tokens</code> ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>tokens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'tallest_'</span><span class="token punctuation">,</span> <span class="token string">'fatter_'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>segment_BPE<span class="token punctuation">(</span>tokens<span class="token punctuation">,</span> symbols<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>['tall e s t _', 'fa t t er_']
</code></pre><h2 id="å°ç»“"><a class="anchor" href="#å°ç»“">#</a> å°ç»“</h2><ul><li>fastText æ¨¡å‹æå‡ºäº†ä¸€ç§å­è¯åµŒå…¥æ–¹æ³•ï¼šåŸºäº word2vec ä¸­çš„è·³å…ƒæ¨¡å‹ï¼Œå®ƒå°†ä¸­å¿ƒè¯è¡¨ç¤ºä¸ºå…¶å­è¯å‘é‡ä¹‹å’Œã€‚</li><li>å­—èŠ‚å¯¹ç¼–ç æ‰§è¡Œè®­ç»ƒæ•°æ®é›†çš„ç»Ÿè®¡åˆ†æï¼Œä»¥å‘ç°è¯å†…çš„å…¬å…±ç¬¦å·ã€‚ä½œä¸ºä¸€ç§è´ªå¿ƒæ–¹æ³•ï¼Œå­—èŠ‚å¯¹ç¼–ç è¿­ä»£åœ°åˆå¹¶æœ€é¢‘ç¹çš„è¿ç»­ç¬¦å·å¯¹ã€‚</li><li>å­è¯åµŒå…¥å¯ä»¥æé«˜ç¨€æœ‰è¯å’Œè¯å…¸å¤–è¯çš„è¡¨ç¤ºè´¨é‡ã€‚</li></ul><h2 id="ç»ƒä¹ "><a class="anchor" href="#ç»ƒä¹ ">#</a> ç»ƒä¹ </h2><ol><li>ä¾‹å¦‚ï¼Œè‹±è¯­ä¸­å¤§çº¦æœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding="application/x-tex">3\times 10^8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span> ç§å¯èƒ½çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">6</span></span></span></span> - å…ƒç»„ã€‚å­è¯å¤ªå¤šä¼šæœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿæç¤ºï¼šè¯·å‚é˜… fastText è®ºæ–‡ç¬¬ 3.2 èŠ‚æœ«å°¾ :cite: <code>Bojanowski.Grave.Joulin.ea.2017</code> ã€‚</li><li>å¦‚ä½•åœ¨è¿ç»­è¯è¢‹æ¨¡å‹çš„åŸºç¡€ä¸Šè®¾è®¡ä¸€ä¸ªå­è¯åµŒå…¥æ¨¡å‹ï¼Ÿ</li><li>è¦è·å¾—å¤§å°ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> çš„è¯è¡¨ï¼Œå½“åˆå§‹ç¬¦å·è¯è¡¨å¤§å°ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> æ—¶ï¼Œéœ€è¦å¤šå°‘åˆå¹¶æ“ä½œï¼Ÿ</li><li>å¦‚ä½•æ‰©å±•å­—èŠ‚å¯¹ç¼–ç çš„æ€æƒ³æ¥æå–çŸ­è¯­ï¼Ÿ</li></ol><p><span class="exturl" data-url="aHR0cHM6Ly9kaXNjdXNzLmQybC5haS90LzU3NDg=">Discussions</span></p><div class="tags"><a href="/tags/chapter-natural-language-processing-pretraining/" rel="tag"><i class="ic i-tag"></i> chapter_natural-language-processing-pretraining</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-03-04 13:38:25" itemprop="dateModified" datetime="2023-03-04T13:38:25+08:00">2023-03-04</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="yuan å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="yuan æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div><div><img data-src="/images/paypal.png" alt="yuan è´å®"><p>è´å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>yuan <i class="ic i-at"><em>@</em></i>yuan</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/subword-embedding/" title="subword-embedding">https://huang-junyuan.github.io/2023/02/15/ai/pytorchæ·±åº¦å­¦ä¹ /chapter_natural-language-processing-pretraining/subword-embedding/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/word2vec-pretraining/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;zkz0&#x2F;image&#x2F;raw&#x2F;master&#x2F;img&#x2F;img(6).webp" title="word2vec-pretraining"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> chapter_natural-language-processing-pretraining</span><h3>word2vec-pretraining</h3></a></div><div class="item right"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/word2vec/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;zkz0&#x2F;image&#x2F;raw&#x2F;master&#x2F;img&#x2F;img(24).webp" title="word2vec"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> chapter_natural-language-processing-pretraining</span><h3>word2vec</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%90%E8%AF%8D%E5%B5%8C%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">å­è¯åµŒå…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#fasttext%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">fastText æ¨¡å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E5%AF%B9%E7%BC%96%E7%A0%81byte-pair-encoding"><span class="toc-number">1.2.</span> <span class="toc-text">å­—èŠ‚å¯¹ç¼–ç ï¼ˆByte Pair Encodingï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.3.</span> <span class="toc-text">å°ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">1.4.</span> <span class="toc-text">ç»ƒä¹ </span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/bert-dataset/" rel="bookmark" title="bert-dataset">bert-dataset</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/approx-training/" rel="bookmark" title="approx-training">approx-training</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/bert-pretraining/" rel="bookmark" title="bert-pretraining">bert-pretraining</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/glove/" rel="bookmark" title="glove">glove</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/bert/" rel="bookmark" title="bert">bert</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/index/" rel="bookmark" title="index">index</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/similarity-analogy/" rel="bookmark" title="similarity-analogy">similarity-analogy</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/word-embedding-dataset/" rel="bookmark" title="word-embedding-dataset">word-embedding-dataset</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/word2vec/" rel="bookmark" title="word2vec">word2vec</a></li><li class="active"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/subword-embedding/" rel="bookmark" title="subword-embedding">subword-embedding</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/word2vec-pretraining/" rel="bookmark" title="word2vec-pretraining">word2vec-pretraining</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="yuan" data-src="/images/avatar.jpg"><p class="name" itemprop="name">yuan</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">409</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">72</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">61</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><span class="exturl item email" data-url="bWFpbHRvOjIwODM2MzU1MjVAcXEuY29t" title="mailto:2083635525@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>å‹é”</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>é“¾æ¥</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/word2vec-pretraining/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/word2vec/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch/" title="åˆ†ç±»äº pytorch">pytorch</a></div><span><a href="/2022/07/25/ai/pytorch/%E4%BD%BF%E7%94%A8Pytorch%E5%AE%9E%E7%8E%B0%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E8%AF%86%E5%88%AB/" title="ä½¿ç”¨Pytorchå®ç°æ‰‹å†™æ•°å­—è¯†åˆ«">ä½¿ç”¨Pytorchå®ç°æ‰‹å†™æ•°å­—è¯†åˆ«</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/frontend/" title="åˆ†ç±»äº å‰ç«¯">å‰ç«¯</a> <i class="ic i-angle-right"></i> <a href="/categories/frontend/vue/" title="åˆ†ç±»äº vue">vue</a></div><span><a href="/2022/08/05/frontend/vue/vue%E7%BB%84%E4%BB%B6%E5%9F%BA%E7%A1%80-%E4%B8%8B/" title="vueç»„ä»¶åŸºç¡€(ä¸‹)">vueç»„ä»¶åŸºç¡€(ä¸‹)</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/25/computer-science/base/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch/" title="åˆ†ç±»äº pytorch">pytorch</a></div><span><a href="/2022/08/24/ai/pytorch/pytorch%E5%9B%BA%E5%AE%9A%E9%9A%8F%E6%9C%BA%E7%A7%8D%E5%AD%90-%E8%AE%AD%E7%BB%83%E7%A8%B3%E5%AE%9A%E5%A4%8D%E7%8E%B0/" title="pytorchå›ºå®šéšæœºç§å­-è®­ç»ƒç¨³å®šå¤ç°">pytorchå›ºå®šéšæœºç§å­-è®­ç»ƒç¨³å®šå¤ç°</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-recurrent-neural-networks/" title="åˆ†ç±»äº chapter_recurrent-neural-networks">chapter_recurrent-neural-networks</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_recurrent-neural-networks/sequence/" title="sequence">sequence</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/cv/" title="åˆ†ç±»äº cv">cv</a></div><span><a href="/2022/07/21/ai/cv/ncnn%E5%9C%A8window%EF%BC%8Cvs2019%EF%BC%8Ccmake-3-16-5-win64-x64%E7%BC%96%E8%AF%91/" title="ncnnåœ¨windowï¼Œvs2019ï¼Œcmake-3.16.5-win64-x64ç¼–è¯‘">ncnnåœ¨windowï¼Œvs2019ï¼Œcmake-3.16.5-win64-x64ç¼–è¯‘</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/25/computer-science/base/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C/828/test/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-natural-language-processing-pretraining/" title="åˆ†ç±»äº chapter_natural-language-processing-pretraining">chapter_natural-language-processing-pretraining</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/similarity-analogy/" title="similarity-analogy">similarity-analogy</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="åˆ†ç±»äº æ•°æ®åº“">æ•°æ®åº“</a></div><span><a href="/2022/07/24/database/MongoDB/" title="MongoDB">MongoDB</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-natural-language-processing-pretraining/" title="åˆ†ç±»äº chapter_natural-language-processing-pretraining">chapter_natural-language-processing-pretraining</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-pretraining/subword-embedding/" title="subword-embedding">subword-embedding</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 â€“ <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">yuan @ Mi Manchi</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">2.9m å­—</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">43:40</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/02/15/ai/pytorchæ·±åº¦å­¦ä¹ /chapter_natural-language-processing-pretraining/subword-embedding/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>