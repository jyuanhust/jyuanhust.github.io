<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="yuan" href="https://huang-junyuan.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="yuan" href="https://huang-junyuan.github.io/atom.xml"><link rel="alternate" type="application/json" title="yuan" href="https://huang-junyuan.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="chapter_optimization"><link rel="canonical" href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/lr-scheduler/"><title>lr-scheduler - chapter_optimization - pytorchæ·±åº¦å­¦ä¹  - ai | Mi Manchi = yuan = Whatever is worth doing at all is worth doing well</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">lr-scheduler</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2023-02-15 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2023-02-15T00:00:00+08:00">2023-02-15</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>8k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>7 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Mi Manchi</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(79).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(5).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(89).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(80).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(28).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(81).webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/" itemprop="item" rel="index" title="åˆ†ç±»äº ai"><span itemprop="name">ai</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="item" rel="index" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ "><span itemprop="name">pytorchæ·±åº¦å­¦ä¹ </span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-optimization/" itemprop="item" rel="index" title="åˆ†ç±»äº chapter_optimization"><span itemprop="name">chapter_optimization</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/lr-scheduler/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="yuan"><meta itemprop="description" content="Whatever is worth doing at all is worth doing well, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="yuan"></span><div class="body md" itemprop="articleBody"><h1 id="å­¦ä¹ ç‡è°ƒåº¦å™¨"><a class="anchor" href="#å­¦ä¹ ç‡è°ƒåº¦å™¨">#</a> å­¦ä¹ ç‡è°ƒåº¦å™¨</h1><p>ğŸ· <code>sec_scheduler</code></p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨å¦‚ä½•æ›´æ–°æƒé‡å‘é‡çš„ä¼˜åŒ–ç®—æ³•ï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„æ›´æ–°é€Ÿç‡ã€‚<br>ç„¶è€Œï¼Œè°ƒæ•´å­¦ä¹ ç‡é€šå¸¸ä¸å®é™…ç®—æ³•åŒæ ·é‡è¦ï¼Œæœ‰å¦‚ä¸‹å‡ æ–¹é¢éœ€è¦è€ƒè™‘ï¼š</p><ul><li>é¦–å…ˆï¼Œå­¦ä¹ ç‡çš„å¤§å°å¾ˆé‡è¦ã€‚å¦‚æœå®ƒå¤ªå¤§ï¼Œä¼˜åŒ–å°±ä¼šå‘æ•£ï¼›å¦‚æœå®ƒå¤ªå°ï¼Œè®­ç»ƒå°±ä¼šéœ€è¦è¿‡é•¿æ—¶é—´ï¼Œæˆ–è€…æˆ‘ä»¬æœ€ç»ˆåªèƒ½å¾—åˆ°æ¬¡ä¼˜çš„ç»“æœã€‚æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°é—®é¢˜çš„æ¡ä»¶æ•°å¾ˆé‡è¦ï¼ˆæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ :numref: <code>sec_momentum</code> ï¼‰ã€‚ç›´è§‚åœ°è¯´ï¼Œè¿™æ˜¯æœ€ä¸æ•æ„Ÿä¸æœ€æ•æ„Ÿæ–¹å‘çš„å˜åŒ–é‡çš„æ¯”ç‡ã€‚</li><li>å…¶æ¬¡ï¼Œè¡°å‡é€Ÿç‡åŒæ ·å¾ˆé‡è¦ã€‚å¦‚æœå­¦ä¹ ç‡æŒç»­è¿‡é«˜ï¼Œæˆ‘ä»¬å¯èƒ½æœ€ç»ˆä¼šåœ¨æœ€å°å€¼é™„è¿‘å¼¹è·³ï¼Œä»è€Œæ— æ³•è¾¾åˆ°æœ€ä¼˜è§£ã€‚ :numref: <code>sec_minibatch_sgd</code> æ¯”è¾ƒè¯¦ç»†åœ°è®¨è®ºäº†è¿™ä¸€ç‚¹ï¼Œåœ¨ :numref: <code>sec_sgd</code> ä¸­æˆ‘ä»¬åˆ™åˆ†æäº†æ€§èƒ½ä¿è¯ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å¸Œæœ›é€Ÿç‡è¡°å‡ï¼Œä½†è¦æ¯”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mi>t</mi><mrow><mo>âˆ’</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(t^{-\frac{1}{2}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20402em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathcal" style="margin-right:.02778em">O</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9540200000000001em"><span style="top:-3.363em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8443142857142858em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.384em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> æ…¢ï¼Œè¿™æ ·èƒ½æˆä¸ºè§£å†³å‡¸é—®é¢˜çš„ä¸é”™é€‰æ‹©ã€‚</li><li>å¦ä¸€ä¸ªåŒæ ·é‡è¦çš„æ–¹é¢æ˜¯åˆå§‹åŒ–ã€‚è¿™æ—¢æ¶‰åŠå‚æ•°æœ€åˆçš„è®¾ç½®æ–¹å¼ï¼ˆè¯¦æƒ…è¯·å‚é˜… :numref: <code>sec_numerical_stability</code> ï¼‰ï¼Œåˆå…³ç³»åˆ°å®ƒä»¬æœ€åˆçš„æ¼”å˜æ–¹å¼ã€‚è¿™è¢«æˆç§°ä¸º<em>é¢„çƒ­</em>ï¼ˆwarmupï¼‰ï¼Œå³æˆ‘ä»¬æœ€åˆå¼€å§‹å‘ç€è§£å†³æ–¹æ¡ˆè¿ˆè¿›çš„é€Ÿåº¦æœ‰å¤šå¿«ã€‚ä¸€å¼€å§‹çš„å¤§æ­¥å¯èƒ½æ²¡æœ‰å¥½å¤„ï¼Œç‰¹åˆ«æ˜¯å› ä¸ºæœ€åˆçš„å‚æ•°é›†æ˜¯éšæœºçš„ã€‚æœ€åˆçš„æ›´æ–°æ–¹å‘å¯èƒ½ä¹Ÿæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚</li><li>æœ€åï¼Œè¿˜æœ‰è®¸å¤šä¼˜åŒ–å˜ä½“å¯ä»¥æ‰§è¡Œå‘¨æœŸæ€§å­¦ä¹ ç‡è°ƒæ•´ã€‚è¿™è¶…å‡ºäº†æœ¬ç« çš„èŒƒå›´ï¼Œæˆ‘ä»¬å»ºè®®è¯»è€…é˜…è¯» :cite: <code>Izmailov.Podoprikhin.Garipov.ea.2018</code> æ¥äº†è§£ä¸ªä¸­ç»†èŠ‚ã€‚ä¾‹å¦‚ï¼Œå¦‚ä½•é€šè¿‡å¯¹æ•´ä¸ªè·¯å¾„å‚æ•°æ±‚å¹³å‡å€¼æ¥è·å¾—æ›´å¥½çš„è§£ã€‚</li></ul><p>é‰´äºç®¡ç†å­¦ä¹ ç‡éœ€è¦å¾ˆå¤šç»†èŠ‚ï¼Œå› æ­¤å¤§å¤šæ•°æ·±åº¦å­¦ä¹ æ¡†æ¶éƒ½æœ‰è‡ªåŠ¨åº”å¯¹è¿™ä¸ªé—®é¢˜çš„å·¥å…·ã€‚<br>åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢³ç†ä¸åŒçš„è°ƒåº¦ç­–ç•¥å¯¹å‡†ç¡®æ€§çš„å½±å“ï¼Œå¹¶å±•ç¤ºå¦‚ä½•é€šè¿‡<em>å­¦ä¹ ç‡è°ƒåº¦å™¨</em>ï¼ˆlearning rate schedulerï¼‰æ¥æœ‰æ•ˆç®¡ç†ã€‚</p><h2 id="ä¸€ä¸ªç®€å•çš„é—®é¢˜"><a class="anchor" href="#ä¸€ä¸ªç®€å•çš„é—®é¢˜">#</a> ä¸€ä¸ªç®€å•çš„é—®é¢˜</h2><p>æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„é—®é¢˜å¼€å§‹ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥è½»æ¾è®¡ç®—ï¼Œä½†è¶³ä»¥è¯´æ˜è¦ä¹‰ã€‚<br>ä¸ºæ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªç¨å¾®ç°ä»£åŒ–çš„ LeNet ç‰ˆæœ¬ï¼ˆæ¿€æ´»å‡½æ•°ä½¿ç”¨ <code>relu</code> è€Œä¸æ˜¯ <code>sigmoid</code> ï¼Œæ±‡èšå±‚ä½¿ç”¨æœ€å¤§æ±‡èšå±‚è€Œä¸æ˜¯å¹³å‡æ±‡èšå±‚ï¼‰ï¼Œå¹¶åº”ç”¨äº Fashion-MNIST æ•°æ®é›†ã€‚<br>æ­¤å¤–ï¼Œæˆ‘ä»¬æ··åˆç½‘ç»œä»¥æé«˜æ€§èƒ½ã€‚<br>ç”±äºå¤§å¤šæ•°ä»£ç éƒ½æ˜¯æ ‡å‡†çš„ï¼Œæˆ‘ä»¬åªä»‹ç»åŸºç¡€çŸ¥è¯†ï¼Œè€Œä¸åšè¿›ä¸€æ­¥çš„è¯¦ç»†è®¨è®ºã€‚å¦‚æœéœ€è¦ï¼Œè¯·å‚é˜… :numref: <code>chap_cnn</code> è¿›è¡Œå¤ä¹ ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">%</span>matplotlib inline</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> math</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> torch</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> torch <span class="token keyword">import</span> nn</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">import</span> lr_scheduler</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> d2l <span class="token keyword">import</span> torch <span class="token keyword">as</span> d2l</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">def</span> <span class="token function">net_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    model <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        nn<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">return</span> model</pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>loss <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>device <span class="token operator">=</span> d2l<span class="token punctuation">.</span>try_gpu<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>batch_size <span class="token operator">=</span> <span class="token number">256</span></pre></td></tr><tr><td data-num="26"></td><td><pre>train_iter<span class="token punctuation">,</span> test_iter <span class="token operator">=</span> d2l<span class="token punctuation">.</span>load_data_fashion_mnist<span class="token punctuation">(</span>batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment"># ä»£ç å‡ ä¹ä¸ d2l.train_ch6 å®šä¹‰åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸€ç«  LeNet ä¸€èŠ‚ä¸­çš„ç›¸åŒ</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>net<span class="token punctuation">,</span> train_iter<span class="token punctuation">,</span> test_iter<span class="token punctuation">,</span> num_epochs<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> trainer<span class="token punctuation">,</span> device<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>          scheduler<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    net<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    animator <span class="token operator">=</span> d2l<span class="token punctuation">.</span>Animator<span class="token punctuation">(</span>xlabel<span class="token operator">=</span><span class="token string">'epoch'</span><span class="token punctuation">,</span> xlim<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> num_epochs<span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                            legend<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'train loss'</span><span class="token punctuation">,</span> <span class="token string">'train acc'</span><span class="token punctuation">,</span> <span class="token string">'test acc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        metric <span class="token operator">=</span> d2l<span class="token punctuation">.</span>Accumulator<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># train_loss,train_acc,num_examples</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>train_iter<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>            net<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>            trainer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>            X<span class="token punctuation">,</span> y <span class="token operator">=</span> X<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>            y_hat <span class="token operator">=</span> net<span class="token punctuation">(</span>X<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            l <span class="token operator">=</span> loss<span class="token punctuation">(</span>y_hat<span class="token punctuation">,</span> y<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>            l<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            trainer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>            <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="46"></td><td><pre>                metric<span class="token punctuation">.</span>add<span class="token punctuation">(</span>l <span class="token operator">*</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d2l<span class="token punctuation">.</span>accuracy<span class="token punctuation">(</span>y_hat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>            train_loss <span class="token operator">=</span> metric<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> metric<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="48"></td><td><pre>            train_acc <span class="token operator">=</span> metric<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> metric<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">50</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="50"></td><td><pre>                animator<span class="token punctuation">.</span>add<span class="token punctuation">(</span>epoch <span class="token operator">+</span> i <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>train_iter<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="51"></td><td><pre>                             <span class="token punctuation">(</span>train_loss<span class="token punctuation">,</span> train_acc<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>        test_acc <span class="token operator">=</span> d2l<span class="token punctuation">.</span>evaluate_accuracy_gpu<span class="token punctuation">(</span>net<span class="token punctuation">,</span> test_iter<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        animator<span class="token punctuation">.</span>add<span class="token punctuation">(</span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> test_acc<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token keyword">if</span> scheduler<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="57"></td><td><pre>            <span class="token keyword">if</span> scheduler<span class="token punctuation">.</span>__module__ <span class="token operator">==</span> lr_scheduler<span class="token punctuation">.</span>__name__<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="58"></td><td><pre>                <span class="token comment"># UsingPyTorchIn-Builtscheduler</span></pre></td></tr><tr><td data-num="59"></td><td><pre>                scheduler<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="61"></td><td><pre>                <span class="token comment"># Usingcustomdefinedscheduler</span></pre></td></tr><tr><td data-num="62"></td><td><pre>                <span class="token keyword">for</span> param_group <span class="token keyword">in</span> trainer<span class="token punctuation">.</span>param_groups<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="63"></td><td><pre>                    param_group<span class="token punctuation">[</span><span class="token string">'lr'</span><span class="token punctuation">]</span> <span class="token operator">=</span> scheduler<span class="token punctuation">(</span>epoch<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'train loss </span><span class="token interpolation"><span class="token punctuation">&#123;</span>train_loss<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">&#125;</span></span><span class="token string">, train acc </span><span class="token interpolation"><span class="token punctuation">&#123;</span>train_acc<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">&#125;</span></span><span class="token string">, '</span></span></pre></td></tr><tr><td data-num="66"></td><td><pre>          <span class="token string-interpolation"><span class="token string">f'test acc </span><span class="token interpolation"><span class="token punctuation">&#123;</span>test_acc<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚æœä½¿ç”¨é»˜è®¤è®¾ç½®ï¼Œè°ƒç”¨æ­¤ç®—æ³•ä¼šå‘ç”Ÿä»€ä¹ˆã€‚<br>ä¾‹å¦‚è®¾å­¦ä¹ ç‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.3</mn></mrow><annotation encoding="application/x-tex">0.3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span></span></span></span> å¹¶è®­ç»ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn></mrow><annotation encoding="application/x-tex">30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">0</span></span></span></span> æ¬¡è¿­ä»£ã€‚<br>ç•™æ„åœ¨è¶…è¿‡äº†æŸç‚¹ã€æµ‹è¯•å‡†ç¡®åº¦æ–¹é¢çš„è¿›å±•åœæ»æ—¶ï¼Œè®­ç»ƒå‡†ç¡®åº¦å°†å¦‚ä½•ç»§ç»­æé«˜ã€‚<br>ä¸¤æ¡æ›²çº¿ä¹‹é—´çš„é—´éš™è¡¨ç¤ºè¿‡æ‹Ÿåˆã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>lr<span class="token punctuation">,</span> num_epochs <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">30</span></pre></td></tr><tr><td data-num="2"></td><td><pre>net <span class="token operator">=</span> net_fn<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>trainer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span>lr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>train<span class="token punctuation">(</span>net<span class="token punctuation">,</span> train_iter<span class="token punctuation">,</span> test_iter<span class="token punctuation">,</span> num_epochs<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> trainer<span class="token punctuation">,</span> device<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>train loss 0.136, train acc 0.948, test acc 0.884
</code></pre><p><img data-src="/lr-scheduler_files/lr-scheduler_3_1.svg" alt="svg"></p><h2 id="å­¦ä¹ ç‡è°ƒåº¦å™¨-2"><a class="anchor" href="#å­¦ä¹ ç‡è°ƒåº¦å™¨-2">#</a> å­¦ä¹ ç‡è°ƒåº¦å™¨</h2><p>æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªè¿­ä»£è½®æ•°ï¼ˆç”šè‡³åœ¨æ¯ä¸ªå°æ‰¹é‡ï¼‰ä¹‹åå‘ä¸‹è°ƒæ•´å­¦ä¹ ç‡ã€‚<br>ä¾‹å¦‚ï¼Œä»¥åŠ¨æ€çš„æ–¹å¼æ¥å“åº”ä¼˜åŒ–çš„è¿›å±•æƒ…å†µã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>lr <span class="token operator">=</span> <span class="token number">0.1</span></pre></td></tr><tr><td data-num="2"></td><td><pre>trainer<span class="token punctuation">.</span>param_groups<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"lr"</span><span class="token punctuation">]</span> <span class="token operator">=</span> lr</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'learning rate is now </span><span class="token interpolation"><span class="token punctuation">&#123;</span>trainer<span class="token punctuation">.</span>param_groups<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"lr"</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>learning rate is now 0.10
</code></pre><p>æ›´é€šå¸¸è€Œè¨€ï¼Œæˆ‘ä»¬åº”è¯¥å®šä¹‰ä¸€ä¸ªè°ƒåº¦å™¨ã€‚<br>å½“è°ƒç”¨æ›´æ–°æ¬¡æ•°æ—¶ï¼Œå®ƒå°†è¿”å›å­¦ä¹ ç‡çš„é€‚å½“å€¼ã€‚<br>è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•ï¼Œå°†å­¦ä¹ ç‡è®¾ç½®ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î·</mi><mo>=</mo><msub><mi>Î·</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mo>âˆ’</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">\eta = \eta_0 (t + 1)^{-\frac{1}{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.20402em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9540200000000001em"><span style="top:-3.363em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8443142857142858em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.384em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span>ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SquareRootScheduler</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        self<span class="token punctuation">.</span>lr <span class="token operator">=</span> lr</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_update<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>lr <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>num_update <span class="token operator">+</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬åœ¨ä¸€ç³»åˆ—å€¼ä¸Šç»˜åˆ¶å®ƒçš„è¡Œä¸ºã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>scheduler <span class="token operator">=</span> SquareRootScheduler<span class="token punctuation">(</span>lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>d2l<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>scheduler<span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="/lr-scheduler_files/lr-scheduler_9_0.svg" alt="svg"></p><p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™å¯¹åœ¨ Fashion-MNIST æ•°æ®é›†ä¸Šçš„è®­ç»ƒæœ‰ä½•å½±å“ã€‚<br>æˆ‘ä»¬åªæ˜¯æä¾›è°ƒåº¦å™¨ä½œä¸ºè®­ç»ƒç®—æ³•çš„é¢å¤–å‚æ•°ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>net <span class="token operator">=</span> net_fn<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>trainer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>train<span class="token punctuation">(</span>net<span class="token punctuation">,</span> train_iter<span class="token punctuation">,</span> test_iter<span class="token punctuation">,</span> num_epochs<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> trainer<span class="token punctuation">,</span> device<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      scheduler<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>train loss 0.274, train acc 0.900, test acc 0.878
</code></pre><p><img data-src="/lr-scheduler_files/lr-scheduler_11_1.svg" alt="svg"></p><p>è¿™æ¯”ä»¥å‰å¥½ä¸€äº›ï¼šæ›²çº¿æ¯”ä»¥å‰æ›´åŠ å¹³æ»‘ï¼Œå¹¶ä¸”è¿‡æ‹Ÿåˆæ›´å°äº†ã€‚<br>é—æ†¾çš„æ˜¯ï¼Œå…³äºä¸ºä»€ä¹ˆåœ¨ç†è®ºä¸ŠæŸäº›ç­–ç•¥ä¼šå¯¼è‡´è¾ƒè½»çš„è¿‡æ‹Ÿåˆï¼Œæœ‰ä¸€äº›è§‚ç‚¹è®¤ä¸ºï¼Œè¾ƒå°çš„æ­¥é•¿å°†å¯¼è‡´å‚æ•°æ›´æ¥è¿‘é›¶ï¼Œå› æ­¤æ›´ç®€å•ã€‚<br>ä½†æ˜¯ï¼Œè¿™å¹¶ä¸èƒ½å®Œå…¨è§£é‡Šè¿™ç§ç°è±¡ï¼Œå› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰çœŸæ­£åœ°æå‰åœæ­¢ï¼Œè€Œåªæ˜¯è½»æŸ”åœ°é™ä½äº†å­¦ä¹ ç‡ã€‚</p><h2 id="ç­–ç•¥"><a class="anchor" href="#ç­–ç•¥">#</a> ç­–ç•¥</h2><p>è™½ç„¶æˆ‘ä»¬ä¸å¯èƒ½æ¶µç›–æ‰€æœ‰ç±»å‹çš„å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼Œä½†æˆ‘ä»¬ä¼šå°è¯•åœ¨ä¸‹é¢ç®€è¦æ¦‚è¿°å¸¸ç”¨çš„ç­–ç•¥ï¼šå¤šé¡¹å¼è¡°å‡å’Œåˆ†æ®µå¸¸æ•°è¡¨ã€‚<br>æ­¤å¤–ï¼Œä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦åœ¨å®è·µä¸­çš„ä¸€äº›é—®é¢˜ä¸Šè¿è¡Œæ•ˆæœå¾ˆå¥½ã€‚<br>åœ¨æŸäº›é—®é¢˜ä¸Šï¼Œæœ€å¥½åœ¨ä½¿ç”¨è¾ƒé«˜çš„å­¦ä¹ ç‡ä¹‹å‰é¢„çƒ­ä¼˜åŒ–å™¨ã€‚</p><h3 id="å•å› å­è°ƒåº¦å™¨"><a class="anchor" href="#å•å› å­è°ƒåº¦å™¨">#</a> å•å› å­è°ƒåº¦å™¨</h3><p>å¤šé¡¹å¼è¡°å‡çš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆæ˜¯ä¹˜æ³•è¡°å‡ï¼Œå³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î·</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>â†</mo><msub><mi>Î·</mi><mi>t</mi></msub><mo>â‹…</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\eta_{t+1} \leftarrow \eta_t \cdot \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.63889em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.0037em">Î±</span></span></span></span> å…¶ä¸­<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi><mo>âˆˆ</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\alpha \in (0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mord mathnormal" style="margin-right:.0037em">Î±</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>ã€‚<br>ä¸ºäº†é˜²æ­¢å­¦ä¹ ç‡è¡°å‡åˆ°ä¸€ä¸ªåˆç†çš„ä¸‹ç•Œä¹‹ä¸‹ï¼Œ<br>æ›´æ–°æ–¹ç¨‹ç»å¸¸ä¿®æ”¹ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î·</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>â†</mo><mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow></mo><mo stretchy="false">(</mo><msub><mi>Î·</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>Î·</mi><mi>t</mi></msub><mo>â‹…</mo><mi>Î±</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\eta_{t+1} \leftarrow \mathop{\mathrm{max}}(\eta_{\mathrm{min}}, \eta_t \cdot \alpha)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mop"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31750199999999995em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">n</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.0037em">Î±</span><span class="mclose">)</span></span></span></span>ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FactorScheduler</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> factor<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> stop_factor_lr<span class="token operator">=</span><span class="token number">1e-7</span><span class="token punctuation">,</span> base_lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        self<span class="token punctuation">.</span>factor <span class="token operator">=</span> factor</pre></td></tr><tr><td data-num="4"></td><td><pre>        self<span class="token punctuation">.</span>stop_factor_lr <span class="token operator">=</span> stop_factor_lr</pre></td></tr><tr><td data-num="5"></td><td><pre>        self<span class="token punctuation">.</span>base_lr <span class="token operator">=</span> base_lr</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_update<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        self<span class="token punctuation">.</span>base_lr <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>stop_factor_lr<span class="token punctuation">,</span> self<span class="token punctuation">.</span>base_lr <span class="token operator">*</span> self<span class="token punctuation">.</span>factor<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>base_lr</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>scheduler <span class="token operator">=</span> FactorScheduler<span class="token punctuation">(</span>factor<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> stop_factor_lr<span class="token operator">=</span><span class="token number">1e-2</span><span class="token punctuation">,</span> base_lr<span class="token operator">=</span><span class="token number">2.0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>d2l<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>scheduler<span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="/lr-scheduler_files/lr-scheduler_13_0.svg" alt="svg"></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å†…ç½®çš„è°ƒåº¦å™¨ï¼Œä½†åœ¨è¿™é‡Œä»…è§£é‡Šå®ƒä»¬çš„åŠŸèƒ½ã€‚</p><h3 id="å¤šå› å­è°ƒåº¦å™¨"><a class="anchor" href="#å¤šå› å­è°ƒåº¦å™¨">#</a> å¤šå› å­è°ƒåº¦å™¨</h3><p>è®­ç»ƒæ·±åº¦ç½‘ç»œçš„å¸¸è§ç­–ç•¥ä¹‹ä¸€æ˜¯ä¿æŒå­¦ä¹ ç‡ä¸ºä¸€ç»„åˆ†æ®µçš„å¸¸é‡ï¼Œå¹¶ä¸”ä¸æ—¶åœ°æŒ‰ç»™å®šçš„å‚æ•°å¯¹å­¦ä¹ ç‡åšä¹˜æ³•è¡°å‡ã€‚<br>å…·ä½“åœ°è¯´ï¼Œç»™å®šä¸€ç»„é™ä½å­¦ä¹ ç‡çš„æ—¶é—´ç‚¹ï¼Œä¾‹å¦‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mo stretchy="false">{</mo><mn>5</mn><mo separator="true">,</mo><mn>10</mn><mo separator="true">,</mo><mn>20</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">s = \{5, 10, 20\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mord">0</span><span class="mclose">}</span></span></span></span>ï¼Œ<br>æ¯å½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>âˆˆ</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">t \in s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65418em;vertical-align:-.0391em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">s</span></span></span></span> æ—¶ï¼Œé™ä½<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î·</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>â†</mo><msub><mi>Î·</mi><mi>t</mi></msub><mo>â‹…</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\eta_{t+1} \leftarrow \eta_t \cdot \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.63889em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.0037em">Î±</span></span></span></span>ã€‚<br>å‡è®¾æ¯æ­¥ä¸­çš„å€¼å‡åŠï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼å®ç°è¿™ä¸€ç‚¹ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>net <span class="token operator">=</span> net_fn<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>trainer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>scheduler <span class="token operator">=</span> lr_scheduler<span class="token punctuation">.</span>MultiStepLR<span class="token punctuation">(</span>trainer<span class="token punctuation">,</span> milestones<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_lr</span><span class="token punctuation">(</span>trainer<span class="token punctuation">,</span> scheduler<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    lr <span class="token operator">=</span> scheduler<span class="token punctuation">.</span>get_last_lr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    trainer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    scheduler<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">return</span> lr</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>d2l<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>get_lr<span class="token punctuation">(</span>trainer<span class="token punctuation">,</span> scheduler<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                                  <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="/lr-scheduler_files/lr-scheduler_15_0.svg" alt="svg"></p><p>è¿™ç§åˆ†æ®µæ’å®šå­¦ä¹ ç‡è°ƒåº¦èƒŒåçš„ç›´è§‰æ˜¯ï¼Œè®©ä¼˜åŒ–æŒç»­è¿›è¡Œï¼Œç›´åˆ°æƒé‡å‘é‡çš„åˆ†å¸ƒè¾¾åˆ°ä¸€ä¸ªé©»ç‚¹ã€‚<br>æ­¤æ—¶ï¼Œæˆ‘ä»¬æ‰å°†å­¦ä¹ ç‡é™ä½ï¼Œä»¥è·å¾—æ›´é«˜è´¨é‡çš„ä»£ç†æ¥è¾¾åˆ°ä¸€ä¸ªè‰¯å¥½çš„å±€éƒ¨æœ€å°å€¼ã€‚<br>ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨è¿™ç§æ–¹æ³•äº§ç”Ÿæ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>train<span class="token punctuation">(</span>net<span class="token punctuation">,</span> train_iter<span class="token punctuation">,</span> test_iter<span class="token punctuation">,</span> num_epochs<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> trainer<span class="token punctuation">,</span> device<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="2"></td><td><pre>      scheduler<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>train loss 0.180, train acc 0.933, test acc 0.899
</code></pre><p><img data-src="/lr-scheduler_files/lr-scheduler_17_1.svg" alt="svg"></p><h3 id="ä½™å¼¦è°ƒåº¦å™¨"><a class="anchor" href="#ä½™å¼¦è°ƒåº¦å™¨">#</a> ä½™å¼¦è°ƒåº¦å™¨</h3><p>ä½™å¼¦è°ƒåº¦å™¨æ˜¯ :cite: <code>Loshchilov.Hutter.2016</code> æå‡ºçš„ä¸€ç§å¯å‘å¼ç®—æ³•ã€‚<br>å®ƒæ‰€ä¾æ®çš„è§‚ç‚¹æ˜¯ï¼šæˆ‘ä»¬å¯èƒ½ä¸æƒ³åœ¨ä¸€å¼€å§‹å°±å¤ªå¤§åœ°é™ä½å­¦ä¹ ç‡ï¼Œè€Œä¸”å¯èƒ½å¸Œæœ›æœ€ç»ˆèƒ½ç”¨éå¸¸å°çš„å­¦ä¹ ç‡æ¥ â€œæ”¹è¿›â€ è§£å†³æ–¹æ¡ˆã€‚<br>è¿™äº§ç”Ÿäº†ä¸€ä¸ªç±»ä¼¼äºä½™å¼¦çš„è°ƒåº¦ï¼Œå‡½æ•°å½¢å¼å¦‚ä¸‹æ‰€ç¤ºï¼Œå­¦ä¹ ç‡çš„å€¼åœ¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t \in [0, T]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65418em;vertical-align:-.0391em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">]</span></span></span></span> ä¹‹é—´ã€‚</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Î·</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Î·</mi><mi>T</mi></msub><mo>+</mo><mfrac><mrow><msub><mi>Î·</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>Î·</mi><mi>T</mi></msub></mrow><mn>2</mn></mfrac><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mi>cos</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>Ï€</mi><mi>t</mi><mi mathvariant="normal">/</mi><mi>T</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta_t = \eta_T + \frac{\eta_0 - \eta_T}{2} \left(1 + \cos(\pi t/T)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.9463300000000001em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603300000000002em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">Ï€</span><span class="mord mathnormal">t</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0">)</span></span></span></span></span></span></p><p>è¿™é‡Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î·</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\eta_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> æ˜¯åˆå§‹å­¦ä¹ ç‡ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î·</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\eta_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> æ˜¯å½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> æ—¶çš„ç›®æ ‡å­¦ä¹ ç‡ã€‚<br>æ­¤å¤–ï¼Œå¯¹äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t &gt; T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65418em;vertical-align:-.0391em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span>ï¼Œæˆ‘ä»¬åªéœ€å°†å€¼å›ºå®šåˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î·</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\eta_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> è€Œä¸å†å¢åŠ å®ƒã€‚<br>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†æœ€å¤§æ›´æ–°æ­¥æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">T = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">0</span></span></span></span>ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">CosineScheduler</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> max_update<span class="token punctuation">,</span> base_lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> final_lr<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>               warmup_steps<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> warmup_begin_lr<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        self<span class="token punctuation">.</span>base_lr_orig <span class="token operator">=</span> base_lr</pre></td></tr><tr><td data-num="5"></td><td><pre>        self<span class="token punctuation">.</span>max_update <span class="token operator">=</span> max_update</pre></td></tr><tr><td data-num="6"></td><td><pre>        self<span class="token punctuation">.</span>final_lr <span class="token operator">=</span> final_lr</pre></td></tr><tr><td data-num="7"></td><td><pre>        self<span class="token punctuation">.</span>warmup_steps <span class="token operator">=</span> warmup_steps</pre></td></tr><tr><td data-num="8"></td><td><pre>        self<span class="token punctuation">.</span>warmup_begin_lr <span class="token operator">=</span> warmup_begin_lr</pre></td></tr><tr><td data-num="9"></td><td><pre>        self<span class="token punctuation">.</span>max_steps <span class="token operator">=</span> self<span class="token punctuation">.</span>max_update <span class="token operator">-</span> self<span class="token punctuation">.</span>warmup_steps</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">get_warmup_lr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> epoch<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        increase <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>base_lr_orig <span class="token operator">-</span> self<span class="token punctuation">.</span>warmup_begin_lr<span class="token punctuation">)</span> \</pre></td></tr><tr><td data-num="13"></td><td><pre>                       <span class="token operator">*</span> <span class="token builtin">float</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>warmup_steps<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>warmup_begin_lr <span class="token operator">+</span> increase</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> epoch<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">if</span> epoch <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>warmup_steps<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>get_warmup_lr<span class="token punctuation">(</span>epoch<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">if</span> epoch <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>max_update<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            self<span class="token punctuation">.</span>base_lr <span class="token operator">=</span> self<span class="token punctuation">.</span>final_lr <span class="token operator">+</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                self<span class="token punctuation">.</span>base_lr_orig <span class="token operator">-</span> self<span class="token punctuation">.</span>final_lr<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> math<span class="token punctuation">.</span>cos<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                math<span class="token punctuation">.</span>pi <span class="token operator">*</span> <span class="token punctuation">(</span>epoch <span class="token operator">-</span> self<span class="token punctuation">.</span>warmup_steps<span class="token punctuation">)</span> <span class="token operator">/</span> self<span class="token punctuation">.</span>max_steps<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>base_lr</pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>scheduler <span class="token operator">=</span> CosineScheduler<span class="token punctuation">(</span>max_update<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> base_lr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> final_lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>d2l<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>scheduler<span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="/lr-scheduler_files/lr-scheduler_19_0.svg" alt="svg"></p><p>åœ¨è®¡ç®—æœºè§†è§‰çš„èƒŒæ™¯ä¸‹ï¼Œè¿™ä¸ªè°ƒåº¦æ–¹å¼å¯èƒ½äº§ç”Ÿæ”¹è¿›çš„ç»“æœã€‚<br>ä½†è¯·æ³¨æ„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™ç§æ”¹è¿›å¹¶ä¸ä¸€å®šæˆç«‹ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>net <span class="token operator">=</span> net_fn<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>trainer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>train<span class="token punctuation">(</span>net<span class="token punctuation">,</span> train_iter<span class="token punctuation">,</span> test_iter<span class="token punctuation">,</span> num_epochs<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> trainer<span class="token punctuation">,</span> device<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      scheduler<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>train loss 0.180, train acc 0.933, test acc 0.895
</code></pre><p><img data-src="/lr-scheduler_files/lr-scheduler_21_1.svg" alt="svg"></p><h3 id="é¢„çƒ­"><a class="anchor" href="#é¢„çƒ­">#</a> é¢„çƒ­</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåˆå§‹åŒ–å‚æ•°ä¸è¶³ä»¥å¾—åˆ°è‰¯å¥½çš„è§£ã€‚<br>è¿™å¯¹æŸäº›é«˜çº§ç½‘ç»œè®¾è®¡æ¥è¯´å°¤å…¶æ£˜æ‰‹ï¼Œå¯èƒ½å¯¼è‡´ä¸ç¨³å®šçš„ä¼˜åŒ–ç»“æœã€‚<br>å¯¹æ­¤ï¼Œä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªè¶³å¤Ÿå°çš„å­¦ä¹ ç‡ï¼Œ<br>ä»è€Œé˜²æ­¢ä¸€å¼€å§‹å‘æ•£ï¼Œç„¶è€Œè¿™æ ·è¿›å±•å¤ªç¼“æ…¢ã€‚<br>å¦ä¸€æ–¹é¢ï¼Œè¾ƒé«˜çš„å­¦ä¹ ç‡æœ€åˆå°±ä¼šå¯¼è‡´å‘æ•£ã€‚</p><p>è§£å†³è¿™ç§å›°å¢ƒçš„ä¸€ä¸ªç›¸å½“ç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨é¢„çƒ­æœŸï¼Œåœ¨æ­¤æœŸé—´å­¦ä¹ ç‡å°†å¢åŠ è‡³åˆå§‹æœ€å¤§å€¼ï¼Œç„¶åå†·å´ç›´åˆ°ä¼˜åŒ–è¿‡ç¨‹ç»“æŸã€‚<br>ä¸ºäº†ç®€å•èµ·è§ï¼Œé€šå¸¸ä½¿ç”¨çº¿æ€§é€’å¢ã€‚<br>è¿™å¼•å‡ºäº†å¦‚ä¸‹è¡¨æ‰€ç¤ºçš„æ—¶é—´è¡¨ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>scheduler <span class="token operator">=</span> CosineScheduler<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> warmup_steps<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> base_lr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> final_lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>d2l<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>scheduler<span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="/lr-scheduler_files/lr-scheduler_23_0.svg" alt="svg"></p><p>æ³¨æ„ï¼Œè§‚å¯Ÿå‰ 5 ä¸ªè¿­ä»£è½®æ•°çš„æ€§èƒ½ï¼Œç½‘ç»œæœ€åˆæ”¶æ•›å¾—æ›´å¥½ã€‚</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>net <span class="token operator">=</span> net_fn<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>trainer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>train<span class="token punctuation">(</span>net<span class="token punctuation">,</span> train_iter<span class="token punctuation">,</span> test_iter<span class="token punctuation">,</span> num_epochs<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> trainer<span class="token punctuation">,</span> device<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      scheduler<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>train loss 0.204, train acc 0.924, test acc 0.893
</code></pre><p><img data-src="/lr-scheduler_files/lr-scheduler_25_1.svg" alt="svg"></p><p>é¢„çƒ­å¯ä»¥åº”ç”¨äºä»»ä½•è°ƒåº¦å™¨ï¼Œè€Œä¸ä»…ä»…æ˜¯ä½™å¼¦ã€‚<br>æœ‰å…³å­¦ä¹ ç‡è°ƒåº¦çš„æ›´å¤šå®éªŒå’Œæ›´è¯¦ç»†è®¨è®ºï¼Œè¯·å‚é˜… :cite: <code>Gotmare.Keskar.Xiong.ea.2018</code> ã€‚<br>å…¶ä¸­ï¼Œè¿™ç¯‡è®ºæ–‡çš„ç‚¹ç›ä¹‹ç¬”çš„å‘ç°ï¼šé¢„çƒ­é˜¶æ®µé™åˆ¶äº†éå¸¸æ·±çš„ç½‘ç»œä¸­å‚æ•°çš„å‘æ•£ç¨‹åº¦ ã€‚<br>è¿™åœ¨ç›´è§‰ä¸Šæ˜¯æœ‰é“ç†çš„ï¼šåœ¨ç½‘ç»œä¸­é‚£äº›ä¸€å¼€å§‹èŠ±è´¹æœ€å¤šæ—¶é—´å–å¾—è¿›å±•çš„éƒ¨åˆ†ï¼Œéšæœºåˆå§‹åŒ–ä¼šäº§ç”Ÿå·¨å¤§çš„å‘æ•£ã€‚</p><h2 id="å°ç»“"><a class="anchor" href="#å°ç»“">#</a> å°ç»“</h2><ul><li>åœ¨è®­ç»ƒæœŸé—´é€æ­¥é™ä½å­¦ä¹ ç‡å¯ä»¥æé«˜å‡†ç¡®æ€§ï¼Œå¹¶ä¸”å‡å°‘æ¨¡å‹çš„è¿‡æ‹Ÿåˆã€‚</li><li>åœ¨å®éªŒä¸­ï¼Œæ¯å½“è¿›å±•è¶‹äºç¨³å®šæ—¶å°±é™ä½å­¦ä¹ ç‡ï¼Œè¿™æ˜¯å¾ˆæœ‰æ•ˆçš„ã€‚ä»æœ¬è´¨ä¸Šè¯´ï¼Œè¿™å¯ä»¥ç¡®ä¿æˆ‘ä»¬æœ‰æ•ˆåœ°æ”¶æ•›åˆ°ä¸€ä¸ªé€‚å½“çš„è§£ï¼Œä¹Ÿåªæœ‰è¿™æ ·æ‰èƒ½é€šè¿‡é™ä½å­¦ä¹ ç‡æ¥å‡å°å‚æ•°çš„å›ºæœ‰æ–¹å·®ã€‚</li><li>ä½™å¼¦è°ƒåº¦å™¨åœ¨æŸäº›è®¡ç®—æœºè§†è§‰é—®é¢˜ä¸­å¾ˆå—æ¬¢è¿ã€‚</li><li>ä¼˜åŒ–ä¹‹å‰çš„é¢„çƒ­æœŸå¯ä»¥é˜²æ­¢å‘æ•£ã€‚</li><li>ä¼˜åŒ–åœ¨æ·±åº¦å­¦ä¹ ä¸­æœ‰å¤šç§ç”¨é€”ã€‚å¯¹äºåŒæ ·çš„è®­ç»ƒè¯¯å·®è€Œè¨€ï¼Œé€‰æ‹©ä¸åŒçš„ä¼˜åŒ–ç®—æ³•å’Œå­¦ä¹ ç‡è°ƒåº¦ï¼Œé™¤äº†æœ€å¤§é™åº¦åœ°å‡å°‘è®­ç»ƒæ—¶é—´ï¼Œå¯ä»¥å¯¼è‡´æµ‹è¯•é›†ä¸Šä¸åŒçš„æ³›åŒ–å’Œè¿‡æ‹Ÿåˆé‡ã€‚</li></ul><h2 id="ç»ƒä¹ "><a class="anchor" href="#ç»ƒä¹ ">#</a> ç»ƒä¹ </h2><ol><li>è¯•éªŒç»™å®šå›ºå®šå­¦ä¹ ç‡çš„ä¼˜åŒ–è¡Œä¸ºã€‚è¿™ç§æƒ…å†µä¸‹å¯ä»¥è·å¾—çš„æœ€ä½³æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>å¦‚æœæ”¹å˜å­¦ä¹ ç‡ä¸‹é™çš„æŒ‡æ•°ï¼Œæ”¶æ•›æ€§ä¼šå¦‚ä½•æ”¹å˜ï¼Ÿåœ¨å®éªŒä¸­æ–¹ä¾¿èµ·è§ï¼Œä½¿ç”¨ <code>PolyScheduler</code> ã€‚</li><li>å°†ä½™å¼¦è°ƒåº¦å™¨åº”ç”¨äºå¤§å‹è®¡ç®—æœºè§†è§‰é—®é¢˜ï¼Œä¾‹å¦‚è®­ç»ƒ ImageNet æ•°æ®é›†ã€‚ä¸å…¶ä»–è°ƒåº¦å™¨ç›¸æ¯”ï¼Œå®ƒå¦‚ä½•å½±å“æ€§èƒ½ï¼Ÿ</li><li>é¢„çƒ­åº”è¯¥æŒç»­å¤šé•¿æ—¶é—´ï¼Ÿ</li><li>å¯ä»¥è¯•ç€æŠŠä¼˜åŒ–å’Œé‡‡æ ·è”ç³»èµ·æ¥å—ï¼Ÿé¦–å…ˆï¼Œåœ¨éšæœºæ¢¯åº¦æœ—ä¹‹ä¸‡åŠ¨åŠ›å­¦ä¸Šä½¿ç”¨ :cite: <code>Welling.Teh.2011</code> çš„ç»“æœã€‚</li></ol><p><span class="exturl" data-url="aHR0cHM6Ly9kaXNjdXNzLmQybC5haS90LzQzMzQ=">Discussions</span></p><div class="tags"><a href="/tags/chapter-optimization/" rel="tag"><i class="ic i-tag"></i> chapter_optimization</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-03-04 13:38:25" itemprop="dateModified" datetime="2023-03-04T13:38:25+08:00">2023-03-04</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="yuan å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="yuan æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div><div><img data-src="/images/paypal.png" alt="yuan è´å®"><p>è´å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>yuan <i class="ic i-at"><em>@</em></i>yuan</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://huang-junyuan.github.io/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/lr-scheduler/" title="lr-scheduler">https://huang-junyuan.github.io/2023/02/15/ai/pytorchæ·±åº¦å­¦ä¹ /chapter_optimization/lr-scheduler/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/finetuning-bert/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;zkz0&#x2F;image&#x2F;raw&#x2F;master&#x2F;img&#x2F;img(16).webp" title="finetuning-bert"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> chapter_natural-language-processing-applications</span><h3>finetuning-bert</h3></a></div><div class="item right"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/minibatch-sgd/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;zkz0&#x2F;image&#x2F;raw&#x2F;master&#x2F;img&#x2F;img(72).webp" title="minibatch-sgd"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> chapter_optimization</span><h3>minibatch-sgd</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E7%8E%87%E8%B0%83%E5%BA%A6%E5%99%A8"><span class="toc-number">1.</span> <span class="toc-text">å­¦ä¹ ç‡è°ƒåº¦å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.</span> <span class="toc-text">ä¸€ä¸ªç®€å•çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E7%8E%87%E8%B0%83%E5%BA%A6%E5%99%A8-2"><span class="toc-number">1.2.</span> <span class="toc-text">å­¦ä¹ ç‡è°ƒåº¦å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%96%E7%95%A5"><span class="toc-number">1.3.</span> <span class="toc-text">ç­–ç•¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%9B%A0%E5%AD%90%E8%B0%83%E5%BA%A6%E5%99%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">å•å› å­è°ƒåº¦å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E5%9B%A0%E5%AD%90%E8%B0%83%E5%BA%A6%E5%99%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text">å¤šå› å­è°ƒåº¦å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%99%E5%BC%A6%E8%B0%83%E5%BA%A6%E5%99%A8"><span class="toc-number">1.3.3.</span> <span class="toc-text">ä½™å¼¦è°ƒåº¦å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E7%83%AD"><span class="toc-number">1.3.4.</span> <span class="toc-text">é¢„çƒ­</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">å°ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">1.5.</span> <span class="toc-text">ç»ƒä¹ </span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/adadelta/" rel="bookmark" title="adadelta">adadelta</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/adagrad/" rel="bookmark" title="adagrad">adagrad</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/adam/" rel="bookmark" title="adam">adam</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/convexity/" rel="bookmark" title="convexity">convexity</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/gd/" rel="bookmark" title="gd">gd</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/index/" rel="bookmark" title="index">index</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/minibatch-sgd/" rel="bookmark" title="minibatch-sgd">minibatch-sgd</a></li><li class="active"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/lr-scheduler/" rel="bookmark" title="lr-scheduler">lr-scheduler</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/momentum/" rel="bookmark" title="momentum">momentum</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/rmsprop/" rel="bookmark" title="rmsprop">rmsprop</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/optimization-intro/" rel="bookmark" title="optimization-intro">optimization-intro</a></li><li><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/sgd/" rel="bookmark" title="sgd">sgd</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="yuan" data-src="/images/avatar.jpg"><p class="name" itemprop="name">yuan</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">363</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">68</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">59</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><span class="exturl item email" data-url="bWFpbHRvOjIwODM2MzU1MjVAcXEuY29t" title="mailto:2083635525@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>å‹é”</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>é“¾æ¥</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_natural-language-processing-applications/finetuning-bert/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_optimization/minibatch-sgd/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2023/03/02/computer-science/%E9%AB%98%E7%BA%A7%E8%BD%AF%E8%80%83/%E6%A1%88%E4%BE%8B/2020/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/tools/" title="åˆ†ç±»äº tools">tools</a></div><span><a href="/2022/07/26/tools/csdn%E5%8D%9A%E5%AE%A2%E5%AF%BC%E5%87%BA%E4%B8%BAmd/" title="csdnåšå®¢å¯¼å‡ºä¸ºmd">csdnåšå®¢å¯¼å‡ºä¸ºmd</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-linear-networks/" title="åˆ†ç±»äº chapter_linear-networks">chapter_linear-networks</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_linear-networks/softmax-regression-scratch/" title="softmax-regression-scratch">softmax-regression-scratch</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a></div><span><a href="/2022/08/25/ai/base/Evaluation-metrics-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87/" title="Evaluation metricsâ€”â€”æœºå™¨å­¦ä¹ ä¸­å¸¸è§çš„è¯„ä¼°æŒ‡æ ‡">Evaluation metricsâ€”â€”æœºå™¨å­¦ä¹ ä¸­å¸¸è§çš„è¯„ä¼°æŒ‡æ ‡</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-deep-learning-computation/" title="åˆ†ç±»äº chapter_deep-learning-computation">chapter_deep-learning-computation</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_deep-learning-computation/index/" title="index">index</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-convolutional-modern/" title="åˆ†ç±»äº chapter_convolutional-modern">chapter_convolutional-modern</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_convolutional-modern/resnet/" title="resnet">resnet</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/09/03/frontend/javascript/JavaScript%E6%96%87%E6%A1%A3%E5%85%83%E7%B4%A0%E6%93%8D%E4%BD%9C/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/frontend/" title="åˆ†ç±»äº å‰ç«¯">å‰ç«¯</a> <i class="ic i-angle-right"></i> <a href="/categories/frontend/Node-js/" title="åˆ†ç±»äº Node.js">Node.js</a></div><span><a href="/2022/09/08/frontend/Node/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81/" title="æ•°æ®åº“ä¸èº«ä»½è®¤è¯">æ•°æ®åº“ä¸èº«ä»½è®¤è¯</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="åˆ†ç±»äº computer-science">computer-science</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E5%AE%9E%E8%B7%B5MySQL/" title="åˆ†ç±»äº æ•°æ®åº“ç³»ç»ŸåŸç†å®è·µMySQL">æ•°æ®åº“ç³»ç»ŸåŸç†å®è·µMySQL</a></div><span><a href="/2022/08/24/computer-science/base/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E5%AE%9E%E8%B7%B5MySQL/%E5%AE%9E%E8%AE%AD10-%E5%AE%89%E5%85%A8%E6%80%A7%E6%8E%A7%E5%88%B6/" title="å®è®­10-å®‰å…¨æ€§æ§åˆ¶">å®è®­10-å®‰å…¨æ€§æ§åˆ¶</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-computer-vision/" title="åˆ†ç±»äº chapter_computer-vision">chapter_computer-vision</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_computer-vision/index/" title="index">index</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 â€“ <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">yuan @ Mi Manchi</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">2.4m å­—</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">35:46</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/02/15/ai/pytorchæ·±åº¦å­¦ä¹ /chapter_optimization/lr-scheduler/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>