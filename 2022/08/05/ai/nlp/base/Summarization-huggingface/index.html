<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="yuan" href="https://huang-junyuan.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="yuan" href="https://huang-junyuan.github.io/atom.xml"><link rel="alternate" type="application/json" title="yuan" href="https://huang-junyuan.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="è‡ªç„¶è¯­è¨€å¤„ç†"><link rel="canonical" href="https://huang-junyuan.github.io/2022/08/05/ai/nlp/base/Summarization-huggingface/"><title>Summarization - huggingface - nlp - ai | Mi Manchi = yuan = Whatever is worth doing at all is worth doing well</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Summarization - huggingface</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2022-08-05 18:52:49"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2022-08-05T18:52:49+08:00">2022-08-05</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>10k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>9 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Mi Manchi</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(66).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(39).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(38).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(67).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(73).webp"></li><li class="item" data-background-image="https://gitee.com/zkz0/image/raw/master/img/img(11).webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/" itemprop="item" rel="index" title="åˆ†ç±»äº ai"><span itemprop="name">ai</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ai/nlp/" itemprop="item" rel="index" title="åˆ†ç±»äº nlp"><span itemprop="name">nlp</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://huang-junyuan.github.io/2022/08/05/ai/nlp/base/Summarization-huggingface/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="yuan"><meta itemprop="description" content="Whatever is worth doing at all is worth doing well, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="yuan"></span><div class="body md" itemprop="articleBody"><p>æˆ‘ä»¬å°†è®­ç»ƒè‹±è¯­å’Œè¥¿ç­ç‰™è¯­çš„åŒè¯­æ¨¡å‹ã€‚åœ¨æœ¬èŠ‚ç»“æŸæ—¶ï¼Œæ‚¨å°†æ‹¥æœ‰ä¸€ä¸ªå¯ä»¥æ€»ç»“å®¢æˆ·è¯„è®ºçš„æ¨¡å‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><h2 id="preparing-a-multilingual-corpus-å‡†å¤‡å¤šè¯­è¨€è¯­æ–™åº“"><a class="anchor" href="#preparing-a-multilingual-corpus-å‡†å¤‡å¤šè¯­è¨€è¯­æ–™åº“">#</a> Preparing a multilingual corpus å‡†å¤‡å¤šè¯­è¨€è¯­æ–™åº“</h2><p>æˆ‘ä»¬å°†ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9odWdnaW5nZmFjZS5jby9kYXRhc2V0cy9hbWF6b25fcmV2aWV3c19tdWx0aQ==">Multilingual Amazon Reviews Corpus</span> æ¥åˆ›å»ºæˆ‘ä»¬çš„åŒè¯­æ‘˜è¦ç”Ÿæˆå™¨ã€‚æ­¤è¯­æ–™åº“ç”±å…­ç§è¯­è¨€çš„ Amazon äº§å“è¯„è®ºç»„æˆï¼Œé€šå¸¸ç”¨äºå¯¹å¤šè¯­è¨€åˆ†ç±»å™¨è¿›è¡ŒåŸºå‡†æµ‹è¯•ã€‚ä½†æ˜¯ï¼Œç”±äºæ¯ä¸ªè¯„è®ºéƒ½é™„æœ‰ç®€çŸ­çš„æ ‡é¢˜ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¿™äº›æ ‡é¢˜ç”¨ä½œæ¨¡å‹å­¦ä¹ çš„ç›®æ ‡æ‘˜è¦ï¼é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»æ‹¥æŠ±é¢éƒ¨ä¸­å¿ƒä¸‹è½½è‹±è¯­å’Œè¥¿ç­ç‰™è¯­å­é›†ï¼š</p><pre><code>from datasets import load_dataset

spanish_dataset = load_dataset(&quot;amazon_reviews_multi&quot;, &quot;es&quot;)
english_dataset = load_dataset(&quot;amazon_reviews_multi&quot;, &quot;en&quot;)
english_dataset
</code></pre><pre><code>DatasetDict(&#123;
    train: Dataset(&#123;
        features: ['review_id', 'product_id', 'reviewer_id', 'stars', 'review_body', 'review_title', 'language', 'product_category'],
        num_rows: 200000
    &#125;)
    validation: Dataset(&#123;
        features: ['review_id', 'product_id', 'reviewer_id', 'stars', 'review_body', 'review_title', 'language', 'product_category'],
        num_rows: 5000
    &#125;)
    test: Dataset(&#123;
        features: ['review_id', 'product_id', 'reviewer_id', 'stars', 'review_body', 'review_title', 'language', 'product_category'],
        num_rows: 5000
    &#125;)
&#125;)
</code></pre><p>å¦‚æ‚¨æ‰€è§ï¼Œå¯¹äºæ¯ç§è¯­è¨€ï¼Œtrain æœ‰ 200ï¼Œ000 æ¡è¯„è®ºï¼Œæ¯ç§è¯­è¨€ validation å’Œ test æ‹†åˆ†éƒ½æœ‰ 5ï¼Œ000 æ¡è¯„è®ºã€‚æˆ‘ä»¬æ„Ÿå…´è¶£çš„è¯„è®ºä¿¡æ¯åŒ…å«åœ¨ review_body å’Œ review_title åˆ—ä¸­ã€‚è®©æˆ‘ä»¬çœ‹ä¸€äº›ä¾‹å­ï¼Œåˆ›å»ºä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œè®­ç»ƒé›†ä¸­éšæœºæŠ½å–æ ·æœ¬ï¼š</p><pre><code>def show_samples(dataset, num_samples=3, seed=42):
    sample = dataset[&quot;train&quot;].shuffle(seed=seed).select(range(num_samples))
    for example in sample:
        print(f&quot;\n'&gt;&gt; Title: &#123;example['review_title']&#125;'&quot;)
        print(f&quot;'&gt;&gt; Review: &#123;example['review_body']&#125;'&quot;)


show_samples(english_dataset)
</code></pre><pre><code>'&gt;&gt; Title: Worked in front position, not rear'
'&gt;&gt; Review: 3 stars because these are not rear brakes as stated in the item description. At least the mount adapter only worked on the front fork of the bike that I got it for.'

'&gt;&gt; Title: meh'
'&gt;&gt; Review: Does itâ€™s job and itâ€™s gorgeous but mine is falling apart, I had to basically put it together again with hot glue'

'&gt;&gt; Title: Can\'t beat these for the money'
'&gt;&gt; Review: Bought this for handling miscellaneous aircraft parts and hanger &quot;stuff&quot; that I needed to organize; it really fit the bill. The unit arrived quickly, was well packaged and arrived intact (always a good sign). There are five wall mounts-- three on the top and two on the bottom. I wanted to mount it on the wall, so all I had to do was to remove the top two layers of plastic drawers, as well as the bottom corner drawers, place it when I wanted and mark it; I then used some of the new plastic screw in wall anchors (the 50 pound variety) and it easily mounted to the wall. Some have remarked that they wanted dividers for the drawers, and that they made those. Good idea. My application was that I needed something that I can see the contents at about eye level, so I wanted the fuller-sized drawers. I also like that these are the new plastic that doesn\'t get brittle and split like my older plastic drawers did. I like the all-plastic construction. It\'s heavy duty enough to hold metal parts, but being made of plastic it\'s not as heavy as a metal frame, so you can easily mount it to the wall and still load it up with heavy stuff, or light stuff. No problem there. For the money, you can\'t beat it. Best one of these I\'ve bought to date-- and I\'ve been using some version of these for over forty years.'
</code></pre><p>æˆ‘ä»¬å°†ä¸“æ³¨äºä¸ºå•ä¸ªäº§å“åŸŸç”Ÿæˆæ‘˜è¦ã€‚ä¸ºäº†äº†è§£æˆ‘ä»¬å¯ä»¥é€‰æ‹©å“ªäº›åŸŸåï¼Œè®©æˆ‘ä»¬è½¬æ¢ english_dataset ä¸º pandas å¹¶è®¡ç®—æ¯ä¸ªäº§å“ç±»åˆ«çš„è¯„è®ºæ•°é‡</p><p><code>english_dataset.set_format(&quot;pandas&quot;)</code> æ”¹å˜äº†æ•°æ®é›†ä¸­è¡¨çš„ç»„ç»‡æ–¹å¼ï¼Œå…¶ä»–çš„æ²¡å˜ã€‚åŸå…ˆè¡¨æ˜¯ç”¨å­—å…¸çš„å½¢å¼å­˜æ”¾çš„ï¼Œç°åœ¨å˜æˆäº† <code>pandas.core.frame.DataFrame</code> ï¼Œ</p><p><img data-src="/./images/Summarization-huggingface/1662593301032.png" alt="1662593301032"></p><p><img data-src="/./images/Summarization-huggingface/1662593446948.png" alt="1662593446948"></p><pre><code>english_dataset.set_format(&quot;pandas&quot;)
english_df = english_dataset[&quot;train&quot;][:]
# Show counts for top 20 products
english_df[&quot;product_category&quot;].value_counts()[:20]
</code></pre><pre><code>home                      17679
apparel                   15951
wireless                  15717
other                     13418
beauty                    12091
drugstore                 11730
kitchen                   10382
toy                        8745
sports                     8277
automotive                 7506
lawn_and_garden            7327
home_improvement           7136
pet_products               7082
digital_ebook_purchase     6749
pc                         6401
electronics                6186
office_product             5521
shoes                      5197
grocery                    4730
book                       3756
Name: product_category, dtype: int64
</code></pre><p>ä»…ä½¿ç”¨ book å’Œ digital_ebook_purchase éƒ¨åˆ†æ•°æ®é›†ï¼Œä½¿ç”¨ Dataset.filter () å‡½æ•°ã€‚</p><pre><code>def filter_books(example):
    return (
        example[&quot;product_category&quot;] == &quot;book&quot;
        or example[&quot;product_category&quot;] == &quot;digital_ebook_purchase&quot;
    )
</code></pre><p>ç°åœ¨ï¼Œå½“æˆ‘ä»¬å°†æ­¤å‡½æ•°åº”ç”¨äº english_dataset å’Œ spanish_dataset æ—¶ï¼Œç»“æœå°†ä»…åŒ…å«æ¶‰åŠä¹¦ç±ç±»åˆ«çš„é‚£äº›è¡Œã€‚åœ¨åº”ç”¨è¿‡æ»¤å™¨ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å°† english_dataset çš„æ ¼å¼ä» pandas åˆ‡æ¢å› arrow</p><pre><code>english_dataset.reset_format()
</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åº”ç”¨è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œä½œä¸ºå¥å…¨æ€§æ£€æŸ¥ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸ªè¯„è®ºæ ·æœ¬ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦ç¡®å®æ˜¯å…³äºä¹¦ç±çš„</p><pre><code>spanish_books = spanish_dataset.filter(filter_books)
english_books = english_dataset.filter(filter_books)
show_samples(english_books)

</code></pre><pre><code>'&gt;&gt; Title: I\'m dissapointed.'
'&gt;&gt; Review: I guess I had higher expectations for this book from the reviews. I really thought I\'d at least like it. The plot idea was great. I loved Ash but, it just didnt go anywhere. Most of the book was about their radio show and talking to callers. I wanted the author to dig deeper so we could really get to know the characters. All we know about Grace is that she is attractive looking, Latino and is kind of a brat. I\'m dissapointed.'

'&gt;&gt; Title: Good art, good price, poor design'
'&gt;&gt; Review: I had gotten the DC Vintage calendar the past two years, but it was on backorder forever this year and I saw they had shrunk the dimensions for no good reason. This one has good art choices but the design has the fold going through the picture, so it\'s less aesthetically pleasing, especially if you want to keep a picture to hang. For the price, a good calendar'

'&gt;&gt; Title: Helpful'
'&gt;&gt; Review: Nearly all the tips useful and. I consider myself an intermediate to advanced user of OneNote. I would highly recommend.'
</code></pre><p>å¥½çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯„è®ºå¹¶ä¸ä¸¥æ ¼åœ°ä¸ä¹¦ç±æœ‰å…³ï¼Œå¹¶ä¸”å¯èƒ½æ¶‰åŠæ—¥å†å’Œç”µå­åº”ç”¨ç¨‹åºï¼ˆå¦‚ OneNoteï¼‰ä¹‹ç±»çš„å†…å®¹ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¯¥é¢†åŸŸä¼¼ä¹å¯ä»¥è®­ç»ƒä¸€ä¸ªæ€»ç»“æ¨¡å‹ã€‚åœ¨æˆ‘ä»¬æŸ¥çœ‹é€‚åˆæ­¤ä»»åŠ¡çš„å„ç§æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æœ‰æœ€åä¸€ç‚¹æ•°æ®å‡†å¤‡å·¥ä½œè¦åšï¼šå°†è‹±è¯­å’Œè¥¿ç­ç‰™è¯­è¯„è®ºåˆå¹¶ä¸ºä¸€ä¸ª DatasetDict å¯¹è±¡ã€‚ Datasets æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„ concatenate_datasets () å‡½æ•°ï¼ˆé¡¾åæ€ä¹‰ï¼‰å°†ä¸¤ä¸ª Dataset å¯¹è±¡å †å åœ¨ä¸€èµ·ã€‚å› æ­¤ï¼Œè¦åˆ›å»ºæˆ‘ä»¬çš„åŒè¯­æ•°æ®é›†ï¼Œæˆ‘ä»¬å°†éå†æ¯ä¸ªæ‹†åˆ†ï¼Œè¿æ¥è¯¥æ‹†åˆ†çš„æ•°æ®é›†ï¼Œç„¶åéšæœºå¤„ç†ç»“æœä»¥ç¡®ä¿æˆ‘ä»¬çš„æ¨¡å‹ä¸ä¼šè¿‡åº¦æ‹Ÿåˆåˆ°ä¸€ç§è¯­è¨€</p><pre><code>english_books.keys()

dict_keys(['train', 'validation', 'test'])
</code></pre><p><img data-src="/./images/Summarization-huggingface/1662594871928.png" alt="1662594871928"></p><p>è§‚å¯Ÿä¸Šé¢çš„è¡Œæ•°ï¼Œå¯çŸ¥ <code>concatenate_datasets()</code> æ˜¯å°†ä¸¤ä¸ªè¡¨çš„è¡Œåˆå¹¶åœ¨ä¸€èµ·ã€‚</p><pre><code>from datasets import concatenate_datasets, DatasetDict

books_dataset = DatasetDict()

for split in english_books.keys():
    books_dataset[split] = concatenate_datasets(
        [english_books[split], spanish_books[split]]
    )
    books_dataset[split] = books_dataset[split].shuffle(seed=42)

# Peek at a few examples
show_samples(books_dataset)
</code></pre><pre><code>'&gt;&gt; Title: å°è¯´æ•…äº‹'
'&gt;&gt; Review: å†…å®¹æ˜¯ç½‘ç»œå°è¯´çš„é‚£ç§æ„Ÿè§‰ï¼Œæ•´æœ¬ä¹¦çš„è´¨æ„Ÿè¿˜æ˜¯ä¸é”™çš„ã€‚ è¿˜é™„èµ äº†ä¸€ä¸ªå°æœ¬ï¼Œç±»ä¼¼å¥æŠ˜çš„é‚£ç§ã€‚'

'&gt;&gt; Title: ä½³å“'
'&gt;&gt; Review: ç‹å”æ™–çš„ä½œå“ï¼Œå†…å®¹æ²¡å¾—è¯´ã€‚è¿™æœ¬å½©è‰²è¿ç¯ç”»å°åˆ·æ¸…æ™°ï¼Œè£…å¸§ç²¾ç¾ ï¼Œé€‚äºæ¬£èµå’Œæ”¶è—ã€‚ä½†ç›¸æ¯”èµ·æ¥ï¼Œä¸ªäººè§‰å¾—åŸç¨¿å°ºå¯¸ç³»åˆ—çš„è¥¿å¢è®°ï¼ˆä¸Šã€ä¸‹ å†Œï¼‰æ›´ä¼˜ï¼š1.å†…å®¹å¤šå‡ºå¾ˆå¤šï¼›2.é»‘ç™½çš„ï¼Œçº¿æ¡ç»†è…»ï¼›3.ç”»å¹…æ›´å¤§ï¼Œæ›´èƒ½ä½“ä¼šåŸä½œçš„éœ‡æ’¼ã€‚'

'&gt;&gt; Title: What A Beautiful Story!'
'&gt;&gt; Review: I simply loved A PERFECTLY SCANDALOUS PROPOSAL! Poignant, passionate, witty, and wonderful, this book touched my heart with its sweetness! I adored our Heroine, Maggie, and admired her for her determination and spunk. She is so easy to love, and our leading man, Gabriel, is simply perfect for our sweet Heroine. I loved the plot, and it flowed smoothly along. A beautiful ten star read!'
</code></pre><p>è¿™å½“ç„¶çœ‹èµ·æ¥åƒæ˜¯è‹±è¯­å’Œè¥¿ç­ç‰™è¯­è¯„è®ºçš„æ··åˆä½“ï¼ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªè®­ç»ƒè¯­æ–™åº“ï¼Œæœ€åè¦æ£€æŸ¥çš„ä¸€ä»¶äº‹æ˜¯è¯„è®ºåŠå…¶æ ‡é¢˜ä¸­å•è¯çš„åˆ†å¸ƒã€‚è¿™å¯¹äºæ±‡æ€»ä»»åŠ¡å°¤å…¶é‡è¦ï¼Œåœ¨æ‘˜è¦ä»»åŠ¡ä¸­ï¼Œæ•°æ®ä¸­çš„ç®€çŸ­å¼•ç”¨æ‘˜è¦å¯èƒ½ä¼šä½¿æ¨¡å‹åå‘äºåœ¨ç”Ÿæˆçš„æ‘˜è¦ä¸­ä»…è¾“å‡ºä¸€ä¸ªæˆ–ä¸¤ä¸ªå•è¯ã€‚ä¸‹é¢çš„å›¾æ˜¾ç¤ºäº†å•è¯åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ ‡é¢˜ä¸¥é‡åå‘äºä»… 1-2 ä¸ªå•è¯ï¼š</p><p><img data-src="/./images/Summarization-huggingface/1662595336000.png" alt="1662595336000"></p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†è¿‡æ»¤æ‰æ ‡é¢˜éå¸¸çŸ­çš„ç¤ºä¾‹ï¼Œä»¥ä¾¿æˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥ç”Ÿæˆæ›´æœ‰è¶£çš„æ‘˜è¦ã€‚ç”±äºæˆ‘ä»¬æ­£åœ¨å¤„ç†è‹±è¯­å’Œè¥¿ç­ç‰™è¯­æ–‡æœ¬ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç²—ç•¥çš„å¯å‘å¼æ–¹æ³•åœ¨ç©ºç™½å¤„æ‹†åˆ†æ ‡é¢˜ï¼Œç„¶åä½¿ç”¨æˆ‘ä»¬çš„ Dataset.filter () æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>books_dataset = books_dataset.filter(lambda x: len(x[&quot;review_title&quot;].split()) &gt; 2)
</code></pre><h2 id="models-for-text-summarization"><a class="anchor" href="#models-for-text-summarization">#</a> Models for text summarization</h2><p>ä»æ­¤è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¤§å¤šæ•°ç”¨äºæ±‡æ€»çš„ Transformer æ¨¡å‹ï¼ˆä»¥åŠå¤§å¤šæ•° NLP ä»»åŠ¡ï¼‰éƒ½æ˜¯å•è¯­çš„ã€‚å¦‚æœæ‚¨çš„ä»»åŠ¡æ˜¯ä½¿ç”¨è‹±è¯­æˆ–å¾·è¯­ç­‰ â€œé«˜èµ„æºâ€ è¯­è¨€ï¼Œé‚£å°±å¤ªå¥½äº†ï¼Œä½†å¯¹äºä¸–ç•Œå„åœ°ä½¿ç”¨çš„æ•°åƒç§å…¶ä»–è¯­è¨€åˆ™ä¸é‚£ä¹ˆé‡è¦ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ç±»å¤šè¯­è¨€å˜å½¢é‡‘åˆšå‹å·ï¼Œå¦‚ mT5 å’Œ mBARTï¼Œå¯ä»¥æŒ½æ•‘ã€‚è¿™äº›æ¨¡å‹æ˜¯ä½¿ç”¨è¯­è¨€å»ºæ¨¡è¿›è¡Œé¢„è®­ç»ƒçš„ï¼Œä½†æœ‰ä¸€ä¸ªè½¬æŠ˜ï¼šå®ƒä»¬ä¸æ˜¯åœ¨ä¸€ç§è¯­è¨€çš„è¯­æ–™åº“ä¸Šè¿›è¡Œè®­ç»ƒï¼Œè€Œæ˜¯åŒæ—¶åœ¨ 50 å¤šç§è¯­è¨€çš„æ–‡æœ¬ä¸Šè¿›è¡Œè”åˆè®­ç»ƒï¼</p><p>æˆ‘ä»¬å°†é‡ç‚¹ä»‹ç» mT5ï¼Œè¿™æ˜¯ä¸€ç§åŸºäº T5 çš„æœ‰è¶£æ¶æ„ï¼Œåœ¨æ–‡æœ¬åˆ°æ–‡æœ¬æ¡†æ¶ä¸­è¿›è¡Œäº†é¢„è®­ç»ƒã€‚åœ¨ T5 ä¸­ï¼Œæ¯ä¸ª NLP ä»»åŠ¡éƒ½æ˜¯æ ¹æ®æç¤ºå‰ç¼€å¦‚æ¥åˆ¶å®šçš„ï¼Œä¾‹å¦‚ summarizeï¼Œæ¨¡å‹æ ¹æ®æç¤ºè°ƒæ•´ç”Ÿæˆçš„æ–‡æœ¬çš„æ¡ä»¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™ä½¿å¾— T5 éå¸¸é€šç”¨ï¼Œå› ä¸ºæ‚¨å¯ä»¥ä½¿ç”¨å•ä¸ªæ¨¡å‹è§£å†³è®¸å¤šä»»åŠ¡ï¼</p><p><img data-src="/./images/Summarization-huggingface/1662596272436.png" alt="1662596272436"></p><p>mT5 ä¸ä½¿ç”¨å‰ç¼€ï¼Œä½†å…·æœ‰ T5 çš„å¤§éƒ¨åˆ†å¤šåŠŸèƒ½æ€§ï¼Œå¹¶å…·æœ‰å¤šè¯­è¨€çš„ä¼˜åŠ¿ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»é€‰æ‹©äº†ä¸€ä¸ªæ¨¡å‹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å‡†å¤‡ç”¨äºè®­ç»ƒçš„æ•°æ®ã€‚</p><h2 id="preprocessing-the-data"><a class="anchor" href="#preprocessing-the-data">#</a> Preprocessing the data</h2><p>æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªä»»åŠ¡æ˜¯æ ‡è®°å’Œç¼–ç æˆ‘ä»¬çš„è¯„è®ºåŠå…¶æ ‡é¢˜ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬é¦–å…ˆåŠ è½½ä¸é¢„è®­ç»ƒçš„æ¨¡å‹æ£€æŸ¥ç‚¹å…³è”çš„åˆ†è¯å™¨ã€‚æˆ‘ä»¬å°† ä½¿ç”¨ mt5-small ä½œä¸ºæ£€æŸ¥ç‚¹ï¼Œä»¥ä¾¿åœ¨åˆç†çš„æ—¶é—´å†…å¾®è°ƒæ¨¡å‹ï¼š</p><p>åœ¨ NLP é¡¹ç›®çš„æ—©æœŸé˜¶æ®µï¼Œä¸€ä¸ªå¥½çš„åšæ³•æ˜¯åœ¨ä¸€å°éƒ¨åˆ†æ•°æ®æ ·æœ¬ä¸Šè®­ç»ƒä¸€ç±» â€œå°â€ æ¨¡å‹ã€‚è¿™ä½¿æ‚¨å¯ä»¥æ›´å¿«åœ°è°ƒè¯•å’Œè¿­ä»£ç«¯åˆ°ç«¯å·¥ä½œæµã€‚ä¸€æ—¦æ‚¨å¯¹ç»“æœæœ‰ä¿¡å¿ƒï¼Œæ‚¨å§‹ç»ˆå¯ä»¥é€šè¿‡ç®€å•åœ°æ›´æ”¹æ¨¡å‹æ£€æŸ¥ç‚¹æ¥æ‰©å±•æ¨¡å‹ï¼</p><p>è®©æˆ‘ä»¬åœ¨ä¸€ä¸ªå°ä¾‹å­ä¸­æµ‹è¯• mT5 åˆ†è¯å™¨</p><pre><code>inputs = tokenizer(&quot;I loved reading the Hunger Games!&quot;)
inputs

&#123;'input_ids': [336, 259, 28387, 11807, 287, 62893, 295, 12507, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1]&#125;
</code></pre><p>è®©æˆ‘ä»¬ä½¿ç”¨åˆ†è¯å™¨çš„ convert_ids_to_tokens () å‡½æ•°å¯¹è¿™äº›è¾“å…¥ ID è¿›è¡Œè§£ç ï¼Œçœ‹çœ‹æˆ‘ä»¬æ­£åœ¨å¤„ç†å“ªç§åˆ†è¯å™¨ï¼š</p><pre><code>tokenizer.convert_ids_to_tokens(inputs.input_ids)

['â–I', 'â–', 'loved', 'â–reading', 'â–the', 'â–Hung', 'er', 'â–Games', '&lt;/s&gt;']
</code></pre><p>ç‰¹æ®Šçš„ Unicode å­—ç¬¦ <code>â–</code> å’Œåºåˆ—ç»“æŸæ ‡è®° <code>&lt;/s&gt;</code> è¡¨ç¤ºæˆ‘ä»¬æ­£åœ¨å¤„ç† SentencePiece tokenizer,ï¼Œå®ƒåŸºäºç¬¬ 6 ç« ä¸­è®¨è®ºçš„ Unigram åˆ†å‰²ç®—æ³•ã€‚Unigram å¯¹äºå¤šè¯­è¨€è¯­æ–™åº“ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸ SentencePiece å¯¹é‡éŸ³ï¼Œæ ‡ç‚¹ç¬¦å·ä»¥åŠè®¸å¤šè¯­è¨€ï¼ˆå¦‚æ—¥è¯­ï¼‰æ²¡æœ‰ç©ºæ ¼å­—ç¬¦çš„äº‹å®ä¸å¯çŸ¥ã€‚</p><h2 id="metrics-for-text-summarization"><a class="anchor" href="#metrics-for-text-summarization">#</a> Metrics for text summarization</h2><p>ä¸æœ¬è¯¾ç¨‹ä¸­ä»‹ç»çš„å¤§å¤šæ•°å…¶ä»–ä»»åŠ¡ç›¸æ¯”ï¼Œè¡¡é‡æ‘˜è¦æˆ–ç¿»è¯‘ç­‰æ–‡æœ¬ç”Ÿæˆä»»åŠ¡çš„æ€§èƒ½å¹¶ä¸é‚£ä¹ˆç®€å•ã€‚ä¾‹å¦‚ï¼Œç»™å®š â€œI loved reading the Hunger Gamesâ€ ä¹‹ç±»çš„è¯„è®ºï¼Œæœ‰å¤šä¸ªæœ‰æ•ˆçš„æ‘˜è¦ï¼Œä¾‹å¦‚ â€œI loved the Hunger Gamesâ€ æˆ– â€œHunger Games is a great readâ€ã€‚æ˜¾ç„¶ï¼Œåœ¨ç”Ÿæˆçš„æ‘˜è¦å’Œæ ‡ç­¾ä¹‹é—´åº”ç”¨æŸç§å®Œå…¨åŒ¹é…å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„è§£å†³æ–¹æ¡ˆ â€”â€” å³ä½¿æ˜¯äººç±»åœ¨è¿™æ ·çš„æŒ‡æ ‡ä¸‹ä¹Ÿä¼šè¡¨ç°ä¸ä½³ï¼Œå› ä¸ºæˆ‘ä»¬éƒ½æœ‰è‡ªå·±çš„å†™ä½œé£æ ¼ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œæœ€å¸¸ç”¨çš„æŒ‡æ ‡ä¹‹ä¸€æ˜¯ <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUk9VR0VfKG1ldHJpYyk=">ROUGE åˆ†æ•°</span>ï¼ˆç”¨äºæŒ‡å¯¼è¯„ä¼°çš„é¢å‘å¬å›çš„å­¦ä¹  Recall-Oriented Understudy for Gisting Evaluation çš„ç¼©å†™ï¼‰ã€‚æ­¤æŒ‡æ ‡èƒŒåçš„åŸºæœ¬æ€æƒ³æ˜¯å°†ç”Ÿæˆçš„æ‘˜è¦ä¸é€šå¸¸ç”±äººç±»åˆ›å»ºçš„ä¸€ç»„å‚è€ƒæ‘˜è¦è¿›è¡Œæ¯”è¾ƒã€‚ä¸ºäº†ä½¿è¿™æ›´ç²¾ç¡®ï¼Œå‡è®¾æˆ‘ä»¬è¦æ¯”è¾ƒä»¥ä¸‹ä¸¤ä¸ªæ‘˜è¦ï¼š</p><pre><code>generated_summary = &quot;I absolutely loved reading the Hunger Games&quot;
reference_summary = &quot;I loved reading the Hunger Games&quot;
</code></pre><p>æ¯”è¾ƒå®ƒä»¬çš„ä¸€ç§æ–¹æ³•æ˜¯è®¡ç®—é‡å å•è¯çš„æ•°é‡ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º 6ã€‚ä½†æ˜¯ï¼Œè¿™æœ‰ç‚¹ç²—ç³™ï¼Œå› æ­¤ ROUGE åŸºäºè®¡ç®—é‡å çš„ç²¾åº¦ precision å’Œå¬å› recall ç‡åˆ†æ•°</p><p><span class="exturl" data-url="aHR0cHM6Ly9zY2lraXQtbGVhcm4ub3JnL3N0YWJsZS9hdXRvX2V4YW1wbGVzL21vZGVsX3NlbGVjdGlvbi9wbG90X3ByZWNpc2lvbl9yZWNhbGwuaHRtbA==">scikit-learn ä¸­çš„å‚è€ƒ</span></p><p>å¯¹äº ROUGEï¼Œå¬å›ç‡è¡¡é‡ç”Ÿæˆçš„å‚è€ƒæ‘˜è¦æ•è·äº†å¤šå°‘å‚è€ƒæ‘˜è¦ã€‚å¦‚æœæˆ‘ä»¬åªæ˜¯æ¯”è¾ƒå•è¯ï¼Œrecall å¯ä»¥æ ¹æ®ä»¥ä¸‹å…¬å¼è®¡ç®—</p><p><img data-src="/./images/Summarization-huggingface/1662598167924.png" alt="1662598167924"></p><p><img data-src="/./images/Summarization-huggingface/1662598174936.png" alt="1662598174936"></p><p>å¯¹äºæˆ‘ä»¬ä¸Šé¢çš„ç®€å•ç¤ºä¾‹ï¼Œæ­¤å…¬å¼ç»™å‡ºäº† 6/6 = 1 çš„å®Œç¾ recall; å³ï¼Œå‚è€ƒæ‘˜è¦ä¸­çš„æ‰€æœ‰å•è¯éƒ½æ˜¯ç”±æ¨¡å‹ç”Ÿæˆçš„ã€‚è¿™å¬èµ·æ¥å¯èƒ½å¾ˆæ£’ï¼Œä½†æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬ç”Ÿæˆçš„æ‘˜è¦æ˜¯ â€œâ€œI really really loved reading the Hunger Games all nightâ€ã€‚è¿™ä¹Ÿå°†å…·æœ‰å®Œç¾ recallï¼Œä½†å¯ä»¥è¯´æ˜¯ä¸€ä¸ªæ›´ç³Ÿç³•çš„æ€»ç»“ï¼Œå› ä¸ºå®ƒæ˜¯å†—é•¿çš„ã€‚ä¸ºäº†å¤„ç†è¿™äº›åœºæ™¯ï¼Œæˆ‘ä»¬è¿˜è®¡ç®—ç²¾åº¦ï¼Œåœ¨ ROUGE ä¸Šä¸‹æ–‡ä¸­ï¼Œç²¾åº¦æµ‹é‡ç”Ÿæˆçš„æ‘˜è¦ä¸­æœ‰å¤šå°‘æ˜¯ç›¸å…³çš„ï¼š</p><p><img data-src="/./images/Summarization-huggingface/1662598304620.png" alt="1662598304620"></p><p><img data-src="/./images/Summarization-huggingface/1662598313457.png" alt="1662598313457"></p><p>å°†æ­¤åº”ç”¨äºæˆ‘ä»¬çš„è¯¦ç»†æ‘˜è¦ä¼šå¾—åˆ° 6/10 = 0.6 çš„ç²¾åº¦ï¼Œè¿™æ¯”æˆ‘ä»¬è¾ƒçŸ­çš„æ‘˜è¦è·å¾—çš„ 6/7 = 0.86 çš„ç²¾åº¦å·®å¾—å¤šã€‚åœ¨å®è·µä¸­ï¼Œé€šå¸¸åŒæ—¶è®¡ç®—ç²¾åº¦å’Œå¬å›ç‡ï¼Œç„¶åæŠ¥å‘Š F1-scoreï¼ˆç²¾åº¦å’Œå¬å›ç‡çš„è°æ³¢å¹³å‡å€¼ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡é¦–å…ˆå®‰è£…è½¯ä»¶åŒ… rouge_score åœ¨ Datasets è½»æ¾å®Œæˆæ­¤æ“ä½œ</p><pre><code>!pip install rouge_score
</code></pre><p>ï¼Œç„¶åæŒ‰å¦‚ä¸‹æ–¹å¼åŠ è½½ ROUGE æŒ‡æ ‡</p><pre><code>import evaluate

rouge_score = evaluate.load(&quot;rouge&quot;)
</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ rouge_score.compute () å‡½æ•°ä¸€æ¬¡è®¡ç®—æ‰€æœ‰æŒ‡æ ‡</p><pre><code>scores = rouge_score.compute(
    predictions=[generated_summary], references=[reference_summary]
)
scores

</code></pre><pre><code>&#123;'rouge1': AggregateScore(low=Score(precision=0.86, recall=1.0, fmeasure=0.92), mid=Score(precision=0.86, recall=1.0, fmeasure=0.92), high=Score(precision=0.86, recall=1.0, fmeasure=0.92)),
 'rouge2': AggregateScore(low=Score(precision=0.67, recall=0.8, fmeasure=0.73), mid=Score(precision=0.67, recall=0.8, fmeasure=0.73), high=Score(precision=0.67, recall=0.8, fmeasure=0.73)),
 'rougeL': AggregateScore(low=Score(precision=0.86, recall=1.0, fmeasure=0.92), mid=Score(precision=0.86, recall=1.0, fmeasure=0.92), high=Score(precision=0.86, recall=1.0, fmeasure=0.92)),
 'rougeLsum': AggregateScore(low=Score(precision=0.86, recall=1.0, fmeasure=0.92), mid=Score(precision=0.86, recall=1.0, fmeasure=0.92), high=Score(precision=0.86, recall=1.0, fmeasure=0.92))&#125;
</code></pre><p>å“‡ï¼Œè¾“å‡ºä¸­æœ‰å¾ˆå¤šä¿¡æ¯ â€”â€” è¿™ä¸€åˆ‡æ„å‘³ç€ä»€ä¹ˆï¼Ÿé¦–å…ˆï¼ŒğŸ¤—æ•°æ®é›†å®é™…ä¸Šè®¡ç®—ç²¾åº¦ï¼Œå¬å›ç‡å’Œ F1 åˆ†æ•°çš„ç½®ä¿¡åŒºé—´ï¼›è¿™äº›æ˜¯æ‚¨å¯ä»¥åœ¨æ­¤å¤„çœ‹åˆ°çš„ lowã€mid å’Œ high å±æ€§ã€‚æ­¤å¤–ï¼Œæ•°æ®é›†åœ¨æ¯”è¾ƒç”Ÿæˆçš„æ‘˜è¦å’Œå‚è€ƒæ‘˜è¦æ—¶ï¼ŒğŸ¤—ä¼šæ ¹æ®ä¸åŒç±»å‹çš„æ–‡æœ¬ç²’åº¦è®¡ç®—å„ç§ ROUGE åˆ†æ•°ã€‚rouge1 æ˜¯ unigrams çš„é‡å  - è¿™åªæ˜¯ä¸€ç§è¯´å•è¯é‡å çš„æ–¹å¼ï¼Œæ­£æ˜¯æˆ‘ä»¬ä¸Šé¢è®¨è®ºçš„æŒ‡æ ‡ã€‚ä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æå–åˆ†æ•°çš„ mid å€¼</p><pre><code>scores[&quot;rouge1&quot;].mid

Score(precision=0.86, recall=1.0, fmeasure=0.92)
</code></pre><p>å¤ªå¥½äº†ï¼Œç²¾åº¦å’Œå¬å›ç‡æ•°å­—åŒ¹é…ï¼é‚£ä¹ˆå…¶ä»–çš„ ROUGE åˆ†æ•°å‘¢ï¼Ÿ rouge2 æµ‹é‡åŒå­—æ¯ä¹‹é—´çš„é‡å ï¼ˆæƒ³æƒ³å•è¯å¯¹çš„é‡å ï¼‰ï¼ŒrougeL rougeLsum åŒæ—¶é€šè¿‡åœ¨ç”Ÿæˆå’Œå‚è€ƒæ‘˜è¦ä¸­æŸ¥æ‰¾æœ€é•¿çš„å¸¸ç”¨å­å­—ç¬¦ä¸²æ¥æµ‹é‡æœ€é•¿çš„å•è¯åŒ¹é…åºåˆ—ã€‚rougeLsum ä¸­çš„ â€œsumâ€ æ˜¯æŒ‡æ­¤æŒ‡æ ‡æ˜¯åœ¨æ•´ä¸ªæ‘˜è¦ä¸­è®¡ç®—çš„ï¼Œè€Œ rougeL ä½œä¸ºå•ä¸ªå¥å­çš„å¹³å‡å€¼è®¡ç®—çš„ã€‚</p><p>Creating a strong baseline</p><p>æ–‡æœ¬æ‘˜è¦çš„å¸¸è§åŸºçº¿æ˜¯ç®€å•åœ°å–æ–‡ç« çš„å‰ä¸‰å¥è¯ï¼Œé€šå¸¸ç§°ä¸º lead-3 åŸºçº¿ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¥å·æ¥è·Ÿè¸ªå¥å­è¾¹ç•Œï¼Œä½†è¿™åœ¨ â€œU.S.â€ æˆ– â€œU.N.â€ ç­‰é¦–å­—æ¯ç¼©ç•¥è¯ä¸Šä¼šå¤±è´¥ - æ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨åº“ nltkï¼Œå…¶ä¸­åŒ…æ‹¬æ›´å¥½çš„ç®—æ³•æ¥å¤„ç†è¿™äº›æƒ…å†µã€‚æ‚¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼å®‰è£…è½¯ä»¶åŒ…</p><div class="tags"><a href="/tags/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86/" rel="tag"><i class="ic i-tag"></i> è‡ªç„¶è¯­è¨€å¤„ç†</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-09-08 09:08:20" itemprop="dateModified" datetime="2022-09-08T09:08:20+08:00">2022-09-08</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="yuan å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="yuan æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div><div><img data-src="/images/paypal.png" alt="yuan è´å®"><p>è´å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>yuan <i class="ic i-at"><em>@</em></i>yuan</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://huang-junyuan.github.io/2022/08/05/ai/nlp/base/Summarization-huggingface/" title="Summarization - huggingface">https://huang-junyuan.github.io/2022/08/05/ai/nlp/base/Summarization-huggingface/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/08/05/ai/nlp/base/%E6%96%87%E6%9C%AC%E6%83%85%E6%84%9F%E5%88%86%E7%B1%BB/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;zkz0&#x2F;image&#x2F;raw&#x2F;master&#x2F;img&#x2F;img(25).webp" title="æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> base</span><h3>æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»</h3></a></div><div class="item right"><a href="/2022/08/09/frontend/base/TypeScript/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;gitee.com&#x2F;zkz0&#x2F;image&#x2F;raw&#x2F;master&#x2F;img&#x2F;img(88).webp" title="TypeScript"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> å‰ç«¯</span><h3>TypeScript</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#preparing-a-multilingual-corpus-%E5%87%86%E5%A4%87%E5%A4%9A%E8%AF%AD%E8%A8%80%E8%AF%AD%E6%96%99%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">Preparing a multilingual corpus å‡†å¤‡å¤šè¯­è¨€è¯­æ–™åº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#models-for-text-summarization"><span class="toc-number">2.</span> <span class="toc-text">Models for text summarization</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#preprocessing-the-data"><span class="toc-number">3.</span> <span class="toc-text">Preprocessing the data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#metrics-for-text-summarization"><span class="toc-number">4.</span> <span class="toc-text">Metrics for text summarization</span></a></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/2022/07/25/ai/nlp/base/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" rel="bookmark" title="å¾ªç¯ç¥ç»ç½‘ç»œåŸºç¡€">å¾ªç¯ç¥ç»ç½‘ç»œåŸºç¡€</a></li><li class="active"><a href="/2022/08/05/ai/nlp/base/Summarization-huggingface/" rel="bookmark" title="Summarization - huggingface">Summarization - huggingface</a></li><li><a href="/2022/08/05/ai/nlp/base/%E6%96%87%E6%9C%AC%E6%83%85%E6%84%9F%E5%88%86%E7%B1%BB/" rel="bookmark" title="æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»">æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»</a></li><li><a href="/2022/08/24/ai/nlp/base/PyTorch-%E4%B8%AD-LSTM-%E7%9A%84-output%E3%80%81h-n-%E5%92%8C-c-n-%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB/" rel="bookmark" title="PyTorch_ä¸­_LSTM_çš„_outputã€h_n_å’Œ_c_n_ä¹‹é—´çš„å…³ç³»">PyTorch_ä¸­_LSTM_çš„_outputã€h_n_å’Œ_c_n_ä¹‹é—´çš„å…³ç³»</a></li><li><a href="/2022/08/24/ai/nlp/base/pytorch%E4%B8%ADLSTM%E7%9A%84output%E5%92%8Chidden%E5%85%B3%E7%B3%BB/" rel="bookmark" title="pytorchä¸­LSTMçš„outputå’Œhiddenå…³ç³»">pytorchä¸­LSTMçš„outputå’Œhiddenå…³ç³»</a></li><li><a href="/2022/08/25/ai/nlp/base/nlp%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/" rel="bookmark" title="nlpçš„æ•°æ®é›†">nlpçš„æ•°æ®é›†</a></li><li><a href="/2022/08/25/ai/nlp/base/transformer/" rel="bookmark" title="transformer">transformer</a></li><li><a href="/2022/09/21/ai/nlp/base/nlp-transformer%E6%A6%82%E8%BF%B0/" rel="bookmark" title="NLPå’Œtransformerå¤§ç±»æ¦‚è¿°">NLPå’Œtransformerå¤§ç±»æ¦‚è¿°</a></li><li><a href="/2022/09/21/ai/nlp/huggingface/DATASETS%E5%BA%93/%E5%88%87%E7%89%87/" rel="bookmark" title="datasets åˆ‡ç‰‡">datasets åˆ‡ç‰‡</a></li><li><a href="/2022/09/22/ai/nlp/base/Subword%E7%AE%97%E6%B3%95/" rel="bookmark" title="Subwordç®—æ³•">Subwordç®—æ³•</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/%E4%B8%BB%E8%A6%81%E7%9A%84%20NLP%20%E4%BB%BB%E5%8A%A1/%E6%96%87%E6%9C%AC%E6%91%98%E8%A6%81Summarization/" rel="bookmark" title="æ–‡æœ¬æ‘˜è¦ summarize">æ–‡æœ¬æ‘˜è¦ summarize</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/%E4%B8%BB%E8%A6%81%E7%9A%84%20NLP%20%E4%BB%BB%E5%8A%A1/%E5%BE%AE%E8%B0%83%E4%B8%80%E4%B8%AA%E6%8E%A9%E7%A0%81%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/" rel="bookmark" title="å¾®è°ƒä¸€ä¸ªæ©ç è¯­è¨€æ¨¡å‹">å¾®è°ƒä¸€ä¸ªæ©ç è¯­è¨€æ¨¡å‹</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/%E4%B8%BB%E8%A6%81%E7%9A%84%20NLP%20%E4%BB%BB%E5%8A%A1/%E9%97%AE%E7%AD%94/" rel="bookmark" title="é—®ç­” question answer">é—®ç­” question answer</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/%E5%BE%AE%E8%B0%83%E4%B8%80%E4%B8%AA%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B/%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/" rel="bookmark" title="å¾®è°ƒä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹-å¤„ç†æ•°æ®">å¾®è°ƒä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹-å¤„ç†æ•°æ®</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/Tokenizers%E5%BA%93/NormalizationAndPre-tokenization/" rel="bookmark" title="Normalization and pre-tokenization">Normalization and pre-tokenization</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/Tokenizers%E5%BA%93/Unigram%E6%A0%87%E8%AE%B0%E5%8C%96/" rel="bookmark" title="Unigram">Unigram</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/Tokenizers%E5%BA%93/BPE/" rel="bookmark" title="Byte-Pair Encoding tokenization">Byte-Pair Encoding tokenization</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/Tokenizers%E5%BA%93/%E6%A0%B9%E6%8D%AE%E5%B7%B2%E6%9C%89%E7%9A%84tokenizer%E8%AE%AD%E7%BB%83%E6%96%B0%E7%9A%84tokenizer/" rel="bookmark" title="æ ¹æ®å·²æœ‰çš„tokenizerè®­ç»ƒæ–°çš„tokenizer">æ ¹æ®å·²æœ‰çš„tokenizerè®­ç»ƒæ–°çš„tokenizer</a></li><li><a href="/2022/11/12/ai/nlp/huggingface/Tokenizers%E5%BA%93/WordPiece/" rel="bookmark" title="WordPiece">WordPiece</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="yuan" data-src="/images/avatar.jpg"><p class="name" itemprop="name">yuan</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">409</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">72</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">61</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><span class="exturl item email" data-url="bWFpbHRvOjIwODM2MzU1MjVAcXEuY29t" title="mailto:2083635525@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>å‹é”</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>é“¾æ¥</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/08/05/ai/nlp/base/%E6%96%87%E6%9C%AC%E6%83%85%E6%84%9F%E5%88%86%E7%B1%BB/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/08/09/frontend/base/TypeScript/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/25/computer-science/algorithm/leetCode/16-%E5%9B%BE/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/backend/" title="åˆ†ç±»äº åç«¯">åç«¯</a> <i class="ic i-angle-right"></i> <a href="/categories/backend/django/" title="åˆ†ç±»äº django">django</a></div><span><a href="/2022/08/25/backend/django/websocket-django/" title="websocket-django">websocket-django</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/25/computer-science/base/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E5%AE%9E%E8%B7%B5MySQL/%E5%AE%9E%E8%AE%AD13-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/frontend/" title="åˆ†ç±»äº å‰ç«¯">å‰ç«¯</a></div><span><a href="/2022/07/24/frontend/CSS/css/" title="CSS">CSS</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-linear-networks/" title="åˆ†ç±»äº chapter_linear-networks">chapter_linear-networks</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_linear-networks/softmax-regression-concise/" title="softmax-regression-concise">softmax-regression-concise</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-recurrent-modern/" title="åˆ†ç±»äº chapter_recurrent-modern">chapter_recurrent-modern</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_recurrent-modern/bi-rnn/" title="bi-rnn">bi-rnn</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/25/computer-science/%E6%AF%94%E8%B5%9B/%E8%93%9D%E6%A1%A5%E6%9D%AF/%E7%9F%A5%E8%AF%86%E7%82%B9%E6%B1%87%E6%80%BB/ES6/%E7%9F%A5%E8%AF%86%E7%82%B9/" title="æœªå‘½å">æœªå‘½å</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº ai">ai</a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="åˆ†ç±»äº pytorchæ·±åº¦å­¦ä¹ ">pytorchæ·±åº¦å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter-multilayer-perceptrons/" title="åˆ†ç±»äº chapter_multilayer-perceptrons">chapter_multilayer-perceptrons</a></div><span><a href="/2023/02/15/ai/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/chapter_multilayer-perceptrons/mlp-concise/" title="mlp-concise">mlp-concise</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/08/24/ai/base/%E6%95%B0%E5%AD%A6-%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0%E6%B1%82%E5%AF%BC%E8%BF%87%E7%A8%8B/" title="æ•°å­¦-å¸¸è§å‡½æ•°æ±‚å¯¼è¿‡ç¨‹">æ•°å­¦-å¸¸è§å‡½æ•°æ±‚å¯¼è¿‡ç¨‹</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/06/25/computer-science/%E6%AF%94%E8%B5%9B/%E9%AB%98%E7%BA%A7%E8%BD%AF%E8%80%83/%E9%80%89%E6%8B%A9%E9%A2%98/%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%80%A7%E8%83%BD%E8%AF%84%E4%BB%B7/" title="æœªå‘½å">æœªå‘½å</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 â€“ <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">yuan @ Mi Manchi</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">2.9m å­—</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">43:40</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/08/05/ai/nlp/base/Summarization-huggingface/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>